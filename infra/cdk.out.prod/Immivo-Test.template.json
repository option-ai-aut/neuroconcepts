{
 "Description": "Testing environment for QA",
 "Resources": {
  "ImmivoVPCB1C78292": {
   "Type": "AWS::EC2::VPC",
   "Properties": {
    "CidrBlock": "10.0.0.0/16",
    "EnableDnsHostnames": true,
    "EnableDnsSupport": true,
    "InstanceTenancy": "default",
    "Tags": [
     {
      "Key": "Name",
      "Value": "Immivo-Test/ImmivoVPC"
     },
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/Resource"
   }
  },
  "ImmivoVPCPublicSubnet1SubnetF66FB41A": {
   "Type": "AWS::EC2::Subnet",
   "Properties": {
    "AvailabilityZone": "eu-central-1a",
    "CidrBlock": "10.0.0.0/24",
    "MapPublicIpOnLaunch": true,
    "Tags": [
     {
      "Key": "aws-cdk:subnet-name",
      "Value": "Public"
     },
     {
      "Key": "aws-cdk:subnet-type",
      "Value": "Public"
     },
     {
      "Key": "Name",
      "Value": "Immivo-Test/ImmivoVPC/PublicSubnet1"
     },
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "VpcId": {
     "Ref": "ImmivoVPCB1C78292"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PublicSubnet1/Subnet"
   }
  },
  "ImmivoVPCPublicSubnet1RouteTable7638AEB2": {
   "Type": "AWS::EC2::RouteTable",
   "Properties": {
    "Tags": [
     {
      "Key": "Name",
      "Value": "Immivo-Test/ImmivoVPC/PublicSubnet1"
     },
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "VpcId": {
     "Ref": "ImmivoVPCB1C78292"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PublicSubnet1/RouteTable"
   }
  },
  "ImmivoVPCPublicSubnet1RouteTableAssociation48A7BC36": {
   "Type": "AWS::EC2::SubnetRouteTableAssociation",
   "Properties": {
    "RouteTableId": {
     "Ref": "ImmivoVPCPublicSubnet1RouteTable7638AEB2"
    },
    "SubnetId": {
     "Ref": "ImmivoVPCPublicSubnet1SubnetF66FB41A"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PublicSubnet1/RouteTableAssociation"
   }
  },
  "ImmivoVPCPublicSubnet1DefaultRoute7933DA36": {
   "Type": "AWS::EC2::Route",
   "Properties": {
    "DestinationCidrBlock": "0.0.0.0/0",
    "GatewayId": {
     "Ref": "ImmivoVPCIGWCE166DAC"
    },
    "RouteTableId": {
     "Ref": "ImmivoVPCPublicSubnet1RouteTable7638AEB2"
    }
   },
   "DependsOn": [
    "ImmivoVPCVPCGWEDE407B3"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PublicSubnet1/DefaultRoute"
   }
  },
  "ImmivoVPCPublicSubnet1EIP6728BF6E": {
   "Type": "AWS::EC2::EIP",
   "Properties": {
    "Domain": "vpc",
    "Tags": [
     {
      "Key": "Name",
      "Value": "Immivo-Test/ImmivoVPC/PublicSubnet1"
     },
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PublicSubnet1/EIP"
   }
  },
  "ImmivoVPCPublicSubnet1NATGateway302E4A39": {
   "Type": "AWS::EC2::NatGateway",
   "Properties": {
    "AllocationId": {
     "Fn::GetAtt": [
      "ImmivoVPCPublicSubnet1EIP6728BF6E",
      "AllocationId"
     ]
    },
    "SubnetId": {
     "Ref": "ImmivoVPCPublicSubnet1SubnetF66FB41A"
    },
    "Tags": [
     {
      "Key": "Name",
      "Value": "Immivo-Test/ImmivoVPC/PublicSubnet1"
     },
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "DependsOn": [
    "ImmivoVPCPublicSubnet1DefaultRoute7933DA36",
    "ImmivoVPCPublicSubnet1RouteTableAssociation48A7BC36"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PublicSubnet1/NATGateway"
   }
  },
  "ImmivoVPCPublicSubnet2SubnetF03A036B": {
   "Type": "AWS::EC2::Subnet",
   "Properties": {
    "AvailabilityZone": "eu-central-1b",
    "CidrBlock": "10.0.1.0/24",
    "MapPublicIpOnLaunch": true,
    "Tags": [
     {
      "Key": "aws-cdk:subnet-name",
      "Value": "Public"
     },
     {
      "Key": "aws-cdk:subnet-type",
      "Value": "Public"
     },
     {
      "Key": "Name",
      "Value": "Immivo-Test/ImmivoVPC/PublicSubnet2"
     },
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "VpcId": {
     "Ref": "ImmivoVPCB1C78292"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PublicSubnet2/Subnet"
   }
  },
  "ImmivoVPCPublicSubnet2RouteTable726D9D65": {
   "Type": "AWS::EC2::RouteTable",
   "Properties": {
    "Tags": [
     {
      "Key": "Name",
      "Value": "Immivo-Test/ImmivoVPC/PublicSubnet2"
     },
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "VpcId": {
     "Ref": "ImmivoVPCB1C78292"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PublicSubnet2/RouteTable"
   }
  },
  "ImmivoVPCPublicSubnet2RouteTableAssociation0487F69E": {
   "Type": "AWS::EC2::SubnetRouteTableAssociation",
   "Properties": {
    "RouteTableId": {
     "Ref": "ImmivoVPCPublicSubnet2RouteTable726D9D65"
    },
    "SubnetId": {
     "Ref": "ImmivoVPCPublicSubnet2SubnetF03A036B"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PublicSubnet2/RouteTableAssociation"
   }
  },
  "ImmivoVPCPublicSubnet2DefaultRouteF3093132": {
   "Type": "AWS::EC2::Route",
   "Properties": {
    "DestinationCidrBlock": "0.0.0.0/0",
    "GatewayId": {
     "Ref": "ImmivoVPCIGWCE166DAC"
    },
    "RouteTableId": {
     "Ref": "ImmivoVPCPublicSubnet2RouteTable726D9D65"
    }
   },
   "DependsOn": [
    "ImmivoVPCVPCGWEDE407B3"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PublicSubnet2/DefaultRoute"
   }
  },
  "ImmivoVPCPrivateSubnet1Subnet5717415A": {
   "Type": "AWS::EC2::Subnet",
   "Properties": {
    "AvailabilityZone": "eu-central-1a",
    "CidrBlock": "10.0.2.0/24",
    "MapPublicIpOnLaunch": false,
    "Tags": [
     {
      "Key": "aws-cdk:subnet-name",
      "Value": "Private"
     },
     {
      "Key": "aws-cdk:subnet-type",
      "Value": "Private"
     },
     {
      "Key": "Name",
      "Value": "Immivo-Test/ImmivoVPC/PrivateSubnet1"
     },
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "VpcId": {
     "Ref": "ImmivoVPCB1C78292"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PrivateSubnet1/Subnet"
   }
  },
  "ImmivoVPCPrivateSubnet1RouteTable1CC356B3": {
   "Type": "AWS::EC2::RouteTable",
   "Properties": {
    "Tags": [
     {
      "Key": "Name",
      "Value": "Immivo-Test/ImmivoVPC/PrivateSubnet1"
     },
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "VpcId": {
     "Ref": "ImmivoVPCB1C78292"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PrivateSubnet1/RouteTable"
   }
  },
  "ImmivoVPCPrivateSubnet1RouteTableAssociation88F519B0": {
   "Type": "AWS::EC2::SubnetRouteTableAssociation",
   "Properties": {
    "RouteTableId": {
     "Ref": "ImmivoVPCPrivateSubnet1RouteTable1CC356B3"
    },
    "SubnetId": {
     "Ref": "ImmivoVPCPrivateSubnet1Subnet5717415A"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PrivateSubnet1/RouteTableAssociation"
   }
  },
  "ImmivoVPCPrivateSubnet1DefaultRouteD999B940": {
   "Type": "AWS::EC2::Route",
   "Properties": {
    "DestinationCidrBlock": "0.0.0.0/0",
    "NatGatewayId": {
     "Ref": "ImmivoVPCPublicSubnet1NATGateway302E4A39"
    },
    "RouteTableId": {
     "Ref": "ImmivoVPCPrivateSubnet1RouteTable1CC356B3"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PrivateSubnet1/DefaultRoute"
   }
  },
  "ImmivoVPCPrivateSubnet2Subnet7191D4D3": {
   "Type": "AWS::EC2::Subnet",
   "Properties": {
    "AvailabilityZone": "eu-central-1b",
    "CidrBlock": "10.0.3.0/24",
    "MapPublicIpOnLaunch": false,
    "Tags": [
     {
      "Key": "aws-cdk:subnet-name",
      "Value": "Private"
     },
     {
      "Key": "aws-cdk:subnet-type",
      "Value": "Private"
     },
     {
      "Key": "Name",
      "Value": "Immivo-Test/ImmivoVPC/PrivateSubnet2"
     },
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "VpcId": {
     "Ref": "ImmivoVPCB1C78292"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PrivateSubnet2/Subnet"
   }
  },
  "ImmivoVPCPrivateSubnet2RouteTable537E4D6A": {
   "Type": "AWS::EC2::RouteTable",
   "Properties": {
    "Tags": [
     {
      "Key": "Name",
      "Value": "Immivo-Test/ImmivoVPC/PrivateSubnet2"
     },
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "VpcId": {
     "Ref": "ImmivoVPCB1C78292"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PrivateSubnet2/RouteTable"
   }
  },
  "ImmivoVPCPrivateSubnet2RouteTableAssociation1E67CE6F": {
   "Type": "AWS::EC2::SubnetRouteTableAssociation",
   "Properties": {
    "RouteTableId": {
     "Ref": "ImmivoVPCPrivateSubnet2RouteTable537E4D6A"
    },
    "SubnetId": {
     "Ref": "ImmivoVPCPrivateSubnet2Subnet7191D4D3"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PrivateSubnet2/RouteTableAssociation"
   }
  },
  "ImmivoVPCPrivateSubnet2DefaultRoute222B9F1A": {
   "Type": "AWS::EC2::Route",
   "Properties": {
    "DestinationCidrBlock": "0.0.0.0/0",
    "NatGatewayId": {
     "Ref": "ImmivoVPCPublicSubnet1NATGateway302E4A39"
    },
    "RouteTableId": {
     "Ref": "ImmivoVPCPrivateSubnet2RouteTable537E4D6A"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/PrivateSubnet2/DefaultRoute"
   }
  },
  "ImmivoVPCIGWCE166DAC": {
   "Type": "AWS::EC2::InternetGateway",
   "Properties": {
    "Tags": [
     {
      "Key": "Name",
      "Value": "Immivo-Test/ImmivoVPC"
     },
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/IGW"
   }
  },
  "ImmivoVPCVPCGWEDE407B3": {
   "Type": "AWS::EC2::VPCGatewayAttachment",
   "Properties": {
    "InternetGatewayId": {
     "Ref": "ImmivoVPCIGWCE166DAC"
    },
    "VpcId": {
     "Ref": "ImmivoVPCB1C78292"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/VPCGW"
   }
  },
  "ImmivoVPCRestrictDefaultSecurityGroupCustomResourceBCBA43EB": {
   "Type": "Custom::VpcRestrictDefaultSG",
   "Properties": {
    "ServiceToken": {
     "Fn::GetAtt": [
      "CustomVpcRestrictDefaultSGCustomResourceProviderHandlerDC833E5E",
      "Arn"
     ]
    },
    "DefaultSecurityGroupId": {
     "Fn::GetAtt": [
      "ImmivoVPCB1C78292",
      "DefaultSecurityGroup"
     ]
    },
    "Account": "463090596988"
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoVPC/RestrictDefaultSecurityGroupCustomResource/Default"
   }
  },
  "CustomVpcRestrictDefaultSGCustomResourceProviderRole26592FE0": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Version": "2012-10-17",
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ]
    },
    "ManagedPolicyArns": [
     {
      "Fn::Sub": "arn:${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
     }
    ],
    "Policies": [
     {
      "PolicyName": "Inline",
      "PolicyDocument": {
       "Version": "2012-10-17",
       "Statement": [
        {
         "Effect": "Allow",
         "Action": [
          "ec2:AuthorizeSecurityGroupIngress",
          "ec2:AuthorizeSecurityGroupEgress",
          "ec2:RevokeSecurityGroupIngress",
          "ec2:RevokeSecurityGroupEgress"
         ],
         "Resource": [
          {
           "Fn::Join": [
            "",
            [
             "arn:aws:ec2:eu-central-1:463090596988:security-group/",
             {
              "Fn::GetAtt": [
               "ImmivoVPCB1C78292",
               "DefaultSecurityGroup"
              ]
             }
            ]
           ]
          }
         ]
        }
       ]
      }
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/Custom::VpcRestrictDefaultSGCustomResourceProvider/Role"
   }
  },
  "CustomVpcRestrictDefaultSGCustomResourceProviderHandlerDC833E5E": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": "cdk-hnb659fds-assets-463090596988-eu-central-1",
     "S3Key": "7fa1e366ee8a9ded01fc355f704cff92bfd179574e6f9cfee800a3541df1b200.zip"
    },
    "Timeout": 900,
    "MemorySize": 128,
    "Handler": "__entrypoint__.handler",
    "Role": {
     "Fn::GetAtt": [
      "CustomVpcRestrictDefaultSGCustomResourceProviderRole26592FE0",
      "Arn"
     ]
    },
    "Runtime": "nodejs22.x",
    "Description": "Lambda function for removing all inbound/outbound rules from the VPC default security group"
   },
   "DependsOn": [
    "CustomVpcRestrictDefaultSGCustomResourceProviderRole26592FE0"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/Custom::VpcRestrictDefaultSGCustomResourceProvider/Handler",
    "aws:asset:path": "asset.7fa1e366ee8a9ded01fc355f704cff92bfd179574e6f9cfee800a3541df1b200",
    "aws:asset:property": "Code"
   }
  },
  "DBSecretD58955BC": {
   "Type": "AWS::SecretsManager::Secret",
   "Properties": {
    "GenerateSecretString": {
     "ExcludePunctuation": true,
     "GenerateStringKey": "password",
     "IncludeSpace": false,
     "SecretStringTemplate": "{\"username\":\"postgres\"}"
    },
    "Name": "Immivo-DB-Secret-test",
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/DBSecret/Resource"
   }
  },
  "DBSecretAttachmentC565A14F": {
   "Type": "AWS::SecretsManager::SecretTargetAttachment",
   "Properties": {
    "SecretId": {
     "Ref": "DBSecretD58955BC"
    },
    "TargetId": {
     "Ref": "PostgresInstance19CDD68A"
    },
    "TargetType": "AWS::RDS::DBInstance"
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/DBSecret/Attachment/Resource"
   }
  },
  "DBSecurityGroupE3B245A3": {
   "Type": "AWS::EC2::SecurityGroup",
   "Properties": {
    "GroupDescription": "Allow access to DB",
    "SecurityGroupEgress": [
     {
      "CidrIp": "255.255.255.255/32",
      "Description": "Disallow all traffic",
      "FromPort": 252,
      "IpProtocol": "icmp",
      "ToPort": 86
     }
    ],
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "VpcId": {
     "Ref": "ImmivoVPCB1C78292"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/DBSecurityGroup/Resource"
   }
  },
  "DBSecurityGroupfromImmivoTestLambdaSecurityGroupA5404BB8543294AAF1A4": {
   "Type": "AWS::EC2::SecurityGroupIngress",
   "Properties": {
    "Description": "Allow Lambda (VPC) to reach DB",
    "FromPort": 5432,
    "GroupId": {
     "Fn::GetAtt": [
      "DBSecurityGroupE3B245A3",
      "GroupId"
     ]
    },
    "IpProtocol": "tcp",
    "SourceSecurityGroupId": {
     "Fn::GetAtt": [
      "LambdaSecurityGroup0BD9FC99",
      "GroupId"
     ]
    },
    "ToPort": 5432
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/DBSecurityGroup/from ImmivoTestLambdaSecurityGroupA5404BB8:5432"
   }
  },
  "LambdaSecurityGroup0BD9FC99": {
   "Type": "AWS::EC2::SecurityGroup",
   "Properties": {
    "GroupDescription": "Orchestrator Lambda - allows all outbound via NAT Gateway",
    "SecurityGroupEgress": [
     {
      "CidrIp": "0.0.0.0/0",
      "Description": "Allow all outbound traffic by default",
      "IpProtocol": "-1"
     }
    ],
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "VpcId": {
     "Ref": "ImmivoVPCB1C78292"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/LambdaSecurityGroup/Resource"
   }
  },
  "PostgresInstanceSubnetGroup84F90C7C": {
   "Type": "AWS::RDS::DBSubnetGroup",
   "Properties": {
    "DBSubnetGroupDescription": "Subnet group for PostgresInstance database",
    "SubnetIds": [
     {
      "Ref": "ImmivoVPCPrivateSubnet1Subnet5717415A"
     },
     {
      "Ref": "ImmivoVPCPrivateSubnet2Subnet7191D4D3"
     }
    ],
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/PostgresInstance/SubnetGroup/Default"
   }
  },
  "PostgresInstance19CDD68A": {
   "Type": "AWS::RDS::DBInstance",
   "Properties": {
    "AllocatedStorage": "20",
    "CopyTagsToSnapshot": true,
    "DBInstanceClass": "db.t4g.micro",
    "DBSubnetGroupName": {
     "Ref": "PostgresInstanceSubnetGroup84F90C7C"
    },
    "DeletionProtection": true,
    "Engine": "postgres",
    "EngineVersion": "16",
    "MasterUserPassword": {
     "Fn::Join": [
      "",
      [
       "{{resolve:secretsmanager:",
       {
        "Ref": "DBSecretD58955BC"
       },
       ":SecretString:password::}}"
      ]
     ]
    },
    "MasterUsername": {
     "Fn::Join": [
      "",
      [
       "{{resolve:secretsmanager:",
       {
        "Ref": "DBSecretD58955BC"
       },
       ":SecretString:username::}}"
      ]
     ]
    },
    "MaxAllocatedStorage": 50,
    "PubliclyAccessible": false,
    "StorageEncrypted": true,
    "StorageType": "gp2",
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "VPCSecurityGroups": [
     {
      "Fn::GetAtt": [
       "DBSecurityGroupE3B245A3",
       "GroupId"
      ]
     }
    ]
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/PostgresInstance/Resource"
   }
  },
  "CognitoEmailKmsKey6CC02FC5": {
   "Type": "AWS::KMS::Key",
   "Properties": {
    "Description": "Immivo Cognito Email Sender KMS Key (test)",
    "EnableKeyRotation": true,
    "KeyPolicy": {
     "Statement": [
      {
       "Action": "kms:*",
       "Effect": "Allow",
       "Principal": {
        "AWS": "arn:aws:iam::463090596988:root"
       },
       "Resource": "*"
      },
      {
       "Action": [
        "kms:CreateGrant",
        "kms:Encrypt"
       ],
       "Effect": "Allow",
       "Principal": {
        "Service": "cognito-idp.amazonaws.com"
       },
       "Resource": "*"
      }
     ],
     "Version": "2012-10-17"
    },
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/CognitoEmailKmsKey/Resource"
   }
  },
  "CognitoEmailKmsKeyAlias1CF22150": {
   "Type": "AWS::KMS::Alias",
   "Properties": {
    "AliasName": "alias/immivo-cognito-email-test",
    "TargetKeyId": {
     "Fn::GetAtt": [
      "CognitoEmailKmsKey6CC02FC5",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/CognitoEmailKmsKey/Alias/Resource"
   }
  },
  "CustomEmailSenderLambdaServiceRoleA213E962": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ],
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/CustomEmailSenderLambda/ServiceRole/Resource"
   }
  },
  "CustomEmailSenderLambdaServiceRoleDefaultPolicy77D6D2A2": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": "kms:Decrypt",
       "Effect": "Allow",
       "Resource": {
        "Fn::GetAtt": [
         "CognitoEmailKmsKey6CC02FC5",
         "Arn"
        ]
       }
      },
      {
       "Action": [
        "secretsmanager:DescribeSecret",
        "secretsmanager:GetSecretValue"
       ],
       "Effect": "Allow",
       "Resource": "arn:aws:secretsmanager:eu-central-1:463090596988:secret:Immivo-App-Secret-test-??????"
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "CustomEmailSenderLambdaServiceRoleDefaultPolicy77D6D2A2",
    "Roles": [
     {
      "Ref": "CustomEmailSenderLambdaServiceRoleA213E962"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/CustomEmailSenderLambda/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "CustomEmailSenderLambdaA1C15DAA": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": "cdk-hnb659fds-assets-463090596988-eu-central-1",
     "S3Key": "618e00fc5df27b7edab44d5517b91ad2da8cba71dd93bfc27b6b02c4002050ec.zip"
    },
    "Environment": {
     "Variables": {
      "KEY_ARN": {
       "Fn::GetAtt": [
        "CognitoEmailKmsKey6CC02FC5",
        "Arn"
       ]
      },
      "APP_SECRET_ARN": "arn:aws:secretsmanager:eu-central-1:463090596988:secret:Immivo-App-Secret-test"
     }
    },
    "FunctionName": "Immivo-CustomEmailSender-test",
    "Handler": "index.handler",
    "MemorySize": 256,
    "Role": {
     "Fn::GetAtt": [
      "CustomEmailSenderLambdaServiceRoleA213E962",
      "Arn"
     ]
    },
    "Runtime": "nodejs22.x",
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "Timeout": 30
   },
   "DependsOn": [
    "CustomEmailSenderLambdaServiceRoleDefaultPolicy77D6D2A2",
    "CustomEmailSenderLambdaServiceRoleA213E962"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/CustomEmailSenderLambda/Resource",
    "aws:asset:path": "asset.618e00fc5df27b7edab44d5517b91ad2da8cba71dd93bfc27b6b02c4002050ec",
    "aws:asset:is-bundled": true,
    "aws:asset:property": "Code"
   }
  },
  "CustomEmailSenderLambdaLogGroup86A507A2": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "LogGroupName": {
     "Fn::Join": [
      "",
      [
       "/aws/lambda/",
       {
        "Ref": "CustomEmailSenderLambdaA1C15DAA"
       }
      ]
     ]
    },
    "RetentionInDays": 731,
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/CustomEmailSenderLambda/LogGroup/Resource"
   }
  },
  "ImmivoUserPoolCustomEmailSenderCognito0BACD330": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "CustomEmailSenderLambdaA1C15DAA",
      "Arn"
     ]
    },
    "Principal": "cognito-idp.amazonaws.com",
    "SourceArn": {
     "Fn::GetAtt": [
      "ImmivoUserPool48AD5837",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoUserPool/CustomEmailSenderCognito"
   }
  },
  "ImmivoUserPool48AD5837": {
   "Type": "AWS::Cognito::UserPool",
   "Properties": {
    "AccountRecoverySetting": {
     "RecoveryMechanisms": [
      {
       "Name": "verified_email",
       "Priority": 1
      }
     ]
    },
    "AdminCreateUserConfig": {
     "AllowAdminCreateUserOnly": false
    },
    "AutoVerifiedAttributes": [
     "email"
    ],
    "EmailVerificationMessage": "The verification code to your new account is {####}",
    "EmailVerificationSubject": "Verify your new account",
    "LambdaConfig": {
     "CustomEmailSender": {
      "LambdaArn": {
       "Fn::GetAtt": [
        "CustomEmailSenderLambdaA1C15DAA",
        "Arn"
       ]
      },
      "LambdaVersion": "V1_0"
     },
     "KMSKeyID": {
      "Fn::GetAtt": [
       "CognitoEmailKmsKey6CC02FC5",
       "Arn"
      ]
     }
    },
    "Policies": {
     "PasswordPolicy": {
      "MinimumLength": 8,
      "RequireLowercase": true,
      "RequireNumbers": true,
      "RequireUppercase": true
     }
    },
    "Schema": [
     {
      "Mutable": true,
      "Name": "given_name",
      "Required": true
     },
     {
      "Mutable": true,
      "Name": "family_name",
      "Required": true
     },
     {
      "Mutable": true,
      "Name": "phone_number",
      "Required": false
     },
     {
      "Mutable": true,
      "Name": "address",
      "Required": false
     },
     {
      "AttributeDataType": "String",
      "Mutable": true,
      "Name": "company_name"
     },
     {
      "AttributeDataType": "String",
      "Mutable": true,
      "Name": "postal_code"
     },
     {
      "AttributeDataType": "String",
      "Mutable": true,
      "Name": "city"
     },
     {
      "AttributeDataType": "String",
      "Mutable": true,
      "Name": "country"
     }
    ],
    "SmsVerificationMessage": "The verification code to your new account is {####}",
    "UserPoolName": "Immivo-Users-test",
    "UserPoolTags": {
     "Project": "Immivo",
     "Stage": "test"
    },
    "UsernameAttributes": [
     "email"
    ],
    "VerificationMessageTemplate": {
     "DefaultEmailOption": "CONFIRM_WITH_CODE",
     "EmailMessage": "The verification code to your new account is {####}",
     "EmailSubject": "Verify your new account",
     "SmsMessage": "The verification code to your new account is {####}"
    }
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoUserPool/Resource"
   }
  },
  "ImmivoUserPoolImmivoClient41F7052B": {
   "Type": "AWS::Cognito::UserPoolClient",
   "Properties": {
    "AllowedOAuthFlows": [
     "implicit",
     "code"
    ],
    "AllowedOAuthFlowsUserPoolClient": true,
    "AllowedOAuthScopes": [
     "profile",
     "phone",
     "email",
     "openid",
     "aws.cognito.signin.user.admin"
    ],
    "CallbackURLs": [
     "https://example.com"
    ],
    "ClientName": "Immivo-Client-test",
    "ExplicitAuthFlows": [
     "ALLOW_USER_SRP_AUTH",
     "ALLOW_REFRESH_TOKEN_AUTH"
    ],
    "GenerateSecret": false,
    "SupportedIdentityProviders": [
     "COGNITO"
    ],
    "UserPoolId": {
     "Ref": "ImmivoUserPool48AD5837"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoUserPool/ImmivoClient/Resource"
   }
  },
  "ImmivoAdminUserPoolCustomEmailSenderCognito1130A1B0": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "CustomEmailSenderLambdaA1C15DAA",
      "Arn"
     ]
    },
    "Principal": "cognito-idp.amazonaws.com",
    "SourceArn": {
     "Fn::GetAtt": [
      "ImmivoAdminUserPool1121EFDE",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoAdminUserPool/CustomEmailSenderCognito"
   }
  },
  "ImmivoAdminUserPool1121EFDE": {
   "Type": "AWS::Cognito::UserPool",
   "Properties": {
    "AccountRecoverySetting": {
     "RecoveryMechanisms": [
      {
       "Name": "verified_email",
       "Priority": 1
      }
     ]
    },
    "AdminCreateUserConfig": {
     "AllowAdminCreateUserOnly": true
    },
    "AutoVerifiedAttributes": [
     "email"
    ],
    "EmailVerificationMessage": "The verification code to your new account is {####}",
    "EmailVerificationSubject": "Verify your new account",
    "LambdaConfig": {
     "CustomEmailSender": {
      "LambdaArn": {
       "Fn::GetAtt": [
        "CustomEmailSenderLambdaA1C15DAA",
        "Arn"
       ]
      },
      "LambdaVersion": "V1_0"
     },
     "KMSKeyID": {
      "Fn::GetAtt": [
       "CognitoEmailKmsKey6CC02FC5",
       "Arn"
      ]
     }
    },
    "Policies": {
     "PasswordPolicy": {
      "MinimumLength": 12,
      "RequireLowercase": true,
      "RequireNumbers": true,
      "RequireSymbols": true,
      "RequireUppercase": true
     }
    },
    "Schema": [
     {
      "Mutable": true,
      "Name": "given_name",
      "Required": true
     },
     {
      "Mutable": true,
      "Name": "family_name",
      "Required": true
     }
    ],
    "SmsVerificationMessage": "The verification code to your new account is {####}",
    "UserPoolName": "Immivo-Admins-test",
    "UserPoolTags": {
     "Project": "Immivo",
     "Stage": "test"
    },
    "UsernameAttributes": [
     "email"
    ],
    "VerificationMessageTemplate": {
     "DefaultEmailOption": "CONFIRM_WITH_CODE",
     "EmailMessage": "The verification code to your new account is {####}",
     "EmailSubject": "Verify your new account",
     "SmsMessage": "The verification code to your new account is {####}"
    }
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoAdminUserPool/Resource"
   }
  },
  "ImmivoAdminUserPoolImmivoAdminClientC11B7155": {
   "Type": "AWS::Cognito::UserPoolClient",
   "Properties": {
    "AllowedOAuthFlows": [
     "implicit",
     "code"
    ],
    "AllowedOAuthFlowsUserPoolClient": true,
    "AllowedOAuthScopes": [
     "profile",
     "phone",
     "email",
     "openid",
     "aws.cognito.signin.user.admin"
    ],
    "CallbackURLs": [
     "https://example.com"
    ],
    "ClientName": "Immivo-Admin-Client-test",
    "ExplicitAuthFlows": [
     "ALLOW_ADMIN_USER_PASSWORD_AUTH",
     "ALLOW_USER_SRP_AUTH",
     "ALLOW_REFRESH_TOKEN_AUTH"
    ],
    "GenerateSecret": false,
    "SupportedIdentityProviders": [
     "COGNITO"
    ],
    "UserPoolId": {
     "Ref": "ImmivoAdminUserPool1121EFDE"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoAdminUserPool/ImmivoAdminClient/Resource"
   }
  },
  "OrchestratorLambdaServiceRole403C7880": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     },
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"
       ]
      ]
     }
    ],
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "DependsOn": [
    "ImmivoVPCPrivateSubnet1DefaultRouteD999B940",
    "ImmivoVPCPrivateSubnet1RouteTableAssociation88F519B0",
    "ImmivoVPCPrivateSubnet2DefaultRoute222B9F1A",
    "ImmivoVPCPrivateSubnet2RouteTableAssociation1E67CE6F"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorLambda/ServiceRole/Resource"
   }
  },
  "OrchestratorLambdaServiceRoleDefaultPolicy32C2103A": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "s3:Abort*",
        "s3:DeleteObject*",
        "s3:GetBucket*",
        "s3:GetObject*",
        "s3:List*",
        "s3:PutObject",
        "s3:PutObjectLegalHold",
        "s3:PutObjectRetention",
        "s3:PutObjectTagging",
        "s3:PutObjectVersionTagging"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "MediaBucketBCBB02BA",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "MediaBucketBCBB02BA",
             "Arn"
            ]
           },
           "/*"
          ]
         ]
        }
       ]
      },
      {
       "Action": [
        "secretsmanager:DescribeSecret",
        "secretsmanager:GetSecretValue"
       ],
       "Effect": "Allow",
       "Resource": [
        "arn:aws:secretsmanager:eu-central-1:463090596988:secret:Immivo-App-Secret-test-??????",
        {
         "Ref": "DBSecretD58955BC"
        }
       ]
      },
      {
       "Action": [
        "cognito-idp:AdminCreateUser",
        "cognito-idp:AdminDeleteUser",
        "cognito-idp:AdminGetUser",
        "cognito-idp:AdminSetUserPassword",
        "cognito-idp:AdminUpdateUserAttributes",
        "cognito-idp:ListUsers"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "ImmivoAdminUserPool1121EFDE",
          "Arn"
         ]
        },
        {
         "Fn::GetAtt": [
          "ImmivoUserPool48AD5837",
          "Arn"
         ]
        }
       ]
      },
      {
       "Action": [
        "ce:GetCostAndUsage",
        "ce:GetCostForecast",
        "ce:GetDimensionValues"
       ],
       "Effect": "Allow",
       "Resource": "*"
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "OrchestratorLambdaServiceRoleDefaultPolicy32C2103A",
    "Roles": [
     {
      "Ref": "OrchestratorLambdaServiceRole403C7880"
     }
    ]
   },
   "DependsOn": [
    "ImmivoVPCPrivateSubnet1DefaultRouteD999B940",
    "ImmivoVPCPrivateSubnet1RouteTableAssociation88F519B0",
    "ImmivoVPCPrivateSubnet2DefaultRoute222B9F1A",
    "ImmivoVPCPrivateSubnet2RouteTableAssociation1E67CE6F"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorLambda/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "OrchestratorLambdaA7A0AD32": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": "cdk-hnb659fds-assets-463090596988-eu-central-1",
     "S3Key": "a1c4457a6e947fde5b64310ee5ecab001785864e1725f2414a4dcb88b1f724d8.zip"
    },
    "Environment": {
     "Variables": {
      "STAGE": "test",
      "DB_SECRET_ARN": {
       "Ref": "DBSecretD58955BC"
      },
      "DB_ENDPOINT": {
       "Fn::GetAtt": [
        "PostgresInstance19CDD68A",
        "Endpoint.Address"
       ]
      },
      "USER_POOL_ID": {
       "Ref": "ImmivoUserPool48AD5837"
      },
      "CLIENT_ID": {
       "Ref": "ImmivoUserPoolImmivoClient41F7052B"
      },
      "ADMIN_USER_POOL_ID": {
       "Ref": "ImmivoAdminUserPool1121EFDE"
      },
      "ADMIN_CLIENT_ID": {
       "Ref": "ImmivoAdminUserPoolImmivoAdminClientC11B7155"
      },
      "APP_SECRET_ARN": "arn:aws:secretsmanager:eu-central-1:463090596988:secret:Immivo-App-Secret-test",
      "BILLING_ENABLED": "false",
      "DEPLOY_TS": "2026-02-25T14:53:12.207Z",
      "MEDIA_BUCKET_NAME": {
       "Ref": "MediaBucketBCBB02BA"
      },
      "MEDIA_CDN_URL": "https://test-media.immivo.ai"
     }
    },
    "Handler": "index.handler",
    "MemorySize": 1024,
    "Role": {
     "Fn::GetAtt": [
      "OrchestratorLambdaServiceRole403C7880",
      "Arn"
     ]
    },
    "Runtime": "nodejs22.x",
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "Timeout": 120,
    "VpcConfig": {
     "SecurityGroupIds": [
      {
       "Fn::GetAtt": [
        "LambdaSecurityGroup0BD9FC99",
        "GroupId"
       ]
      }
     ],
     "SubnetIds": [
      {
       "Ref": "ImmivoVPCPrivateSubnet1Subnet5717415A"
      },
      {
       "Ref": "ImmivoVPCPrivateSubnet2Subnet7191D4D3"
      }
     ]
    }
   },
   "DependsOn": [
    "ImmivoVPCPrivateSubnet1DefaultRouteD999B940",
    "ImmivoVPCPrivateSubnet1RouteTableAssociation88F519B0",
    "ImmivoVPCPrivateSubnet2DefaultRoute222B9F1A",
    "ImmivoVPCPrivateSubnet2RouteTableAssociation1E67CE6F",
    "OrchestratorLambdaServiceRoleDefaultPolicy32C2103A",
    "OrchestratorLambdaServiceRole403C7880"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorLambda/Resource",
    "aws:asset:path": "asset.a1c4457a6e947fde5b64310ee5ecab001785864e1725f2414a4dcb88b1f724d8",
    "aws:asset:is-bundled": true,
    "aws:asset:property": "Code"
   }
  },
  "OrchestratorLambdaLogGroup0594DD42": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "LogGroupName": {
     "Fn::Join": [
      "",
      [
       "/aws/lambda/",
       {
        "Ref": "OrchestratorLambdaA7A0AD32"
       }
      ]
     ]
    },
    "RetentionInDays": 731,
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "DependsOn": [
    "ImmivoVPCPrivateSubnet1DefaultRouteD999B940",
    "ImmivoVPCPrivateSubnet1RouteTableAssociation88F519B0",
    "ImmivoVPCPrivateSubnet2DefaultRoute222B9F1A",
    "ImmivoVPCPrivateSubnet2RouteTableAssociation1E67CE6F"
   ],
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorLambda/LogGroup/Resource"
   }
  },
  "OrchestratorLambdaFunctionUrl11B98229": {
   "Type": "AWS::Lambda::Url",
   "Properties": {
    "AuthType": "NONE",
    "InvokeMode": "BUFFERED",
    "TargetFunctionArn": {
     "Fn::GetAtt": [
      "OrchestratorLambdaA7A0AD32",
      "Arn"
     ]
    }
   },
   "DependsOn": [
    "ImmivoVPCPrivateSubnet1DefaultRouteD999B940",
    "ImmivoVPCPrivateSubnet1RouteTableAssociation88F519B0",
    "ImmivoVPCPrivateSubnet2DefaultRoute222B9F1A",
    "ImmivoVPCPrivateSubnet2RouteTableAssociation1E67CE6F"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorLambda/FunctionUrl/Resource"
   }
  },
  "OrchestratorLambdainvokefunctionurl21E31014": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunctionUrl",
    "FunctionName": {
     "Fn::GetAtt": [
      "OrchestratorLambdaA7A0AD32",
      "Arn"
     ]
    },
    "FunctionUrlAuthType": "NONE",
    "Principal": "*"
   },
   "DependsOn": [
    "ImmivoVPCPrivateSubnet1DefaultRouteD999B940",
    "ImmivoVPCPrivateSubnet1RouteTableAssociation88F519B0",
    "ImmivoVPCPrivateSubnet2DefaultRoute222B9F1A",
    "ImmivoVPCPrivateSubnet2RouteTableAssociation1E67CE6F"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorLambda/invoke-function-url"
   }
  },
  "OrchestratorLambdainvokefunction504B79DD": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "OrchestratorLambdaA7A0AD32",
      "Arn"
     ]
    },
    "InvokedViaFunctionUrl": true,
    "Principal": "*"
   },
   "DependsOn": [
    "ImmivoVPCPrivateSubnet1DefaultRouteD999B940",
    "ImmivoVPCPrivateSubnet1RouteTableAssociation88F519B0",
    "ImmivoVPCPrivateSubnet2DefaultRoute222B9F1A",
    "ImmivoVPCPrivateSubnet2RouteTableAssociation1E67CE6F"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorLambda/invoke-function"
   }
  },
  "MediaBucketBCBB02BA": {
   "Type": "AWS::S3::Bucket",
   "Properties": {
    "BucketEncryption": {
     "ServerSideEncryptionConfiguration": [
      {
       "ServerSideEncryptionByDefault": {
        "SSEAlgorithm": "AES256"
       }
      }
     ]
    },
    "CorsConfiguration": {
     "CorsRules": [
      {
       "AllowedHeaders": [
        "*"
       ],
       "AllowedMethods": [
        "GET",
        "HEAD"
       ],
       "AllowedOrigins": [
        "https://test.immivo.ai",
        "https://app.immivo.ai",
        "https://immivo.ai",
        "https://www.immivo.ai",
        "https://admin.immivo.ai"
       ],
       "ExposedHeaders": [
        "Content-Length",
        "Content-Type",
        "ETag"
       ],
       "MaxAge": 3600
      }
     ]
    },
    "PublicAccessBlockConfiguration": {
     "BlockPublicAcls": true,
     "BlockPublicPolicy": true,
     "IgnorePublicAcls": true,
     "RestrictPublicBuckets": true
    },
    "Tags": [
     {
      "Key": "aws-cdk:cr-owned:public/:3701ac05",
      "Value": "true"
     },
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/MediaBucket/Resource"
   }
  },
  "MediaBucketPolicy68C27F6B": {
   "Type": "AWS::S3::BucketPolicy",
   "Properties": {
    "Bucket": {
     "Ref": "MediaBucketBCBB02BA"
    },
    "PolicyDocument": {
     "Statement": [
      {
       "Action": "s3:*",
       "Condition": {
        "Bool": {
         "aws:SecureTransport": "false"
        }
       },
       "Effect": "Deny",
       "Principal": {
        "AWS": "*"
       },
       "Resource": [
        {
         "Fn::GetAtt": [
          "MediaBucketBCBB02BA",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "MediaBucketBCBB02BA",
             "Arn"
            ]
           },
           "/*"
          ]
         ]
        }
       ]
      },
      {
       "Action": "s3:GetObject",
       "Condition": {
        "StringEquals": {
         "AWS:SourceArn": {
          "Fn::Join": [
           "",
           [
            "arn:",
            {
             "Ref": "AWS::Partition"
            },
            ":cloudfront::",
            {
             "Ref": "AWS::AccountId"
            },
            ":distribution/",
            {
             "Ref": "MediaCDN30A5345E"
            }
           ]
          ]
         }
        }
       },
       "Effect": "Allow",
       "Principal": {
        "Service": "cloudfront.amazonaws.com"
       },
       "Resource": {
        "Fn::Join": [
         "",
         [
          {
           "Fn::GetAtt": [
            "MediaBucketBCBB02BA",
            "Arn"
           ]
          },
          "/*"
         ]
        ]
       }
      }
     ],
     "Version": "2012-10-17"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/MediaBucket/Policy/Resource"
   }
  },
  "OrchestratorApiFA05180E": {
   "Type": "AWS::ApiGateway::RestApi",
   "Properties": {
    "BinaryMediaTypes": [
     "multipart/form-data",
     "image/*",
     "application/octet-stream"
    ],
    "Name": "OrchestratorApi",
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorApi/Resource"
   }
  },
  "OrchestratorApiDeploymentD878F32Eb33b95ac301fb3fd7dc4633ef9040008": {
   "Type": "AWS::ApiGateway::Deployment",
   "Properties": {
    "Description": "Automatically created by the RestApi construct",
    "RestApiId": {
     "Ref": "OrchestratorApiFA05180E"
    }
   },
   "DependsOn": [
    "OrchestratorApiproxyANY03FB7B53",
    "OrchestratorApiproxyOPTIONS0E0C159E",
    "OrchestratorApiproxy426E8F4E",
    "OrchestratorApiANY0AC930C1",
    "OrchestratorApiOPTIONS124BD440",
    "OrchestratorApiDefault4XX21F3CEDD",
    "OrchestratorApiDefault5XX926F0626"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorApi/Deployment/Resource",
    "aws:cdk:do-not-refactor": true
   }
  },
  "OrchestratorApiDeploymentStagetest5B74FABD": {
   "Type": "AWS::ApiGateway::Stage",
   "Properties": {
    "DeploymentId": {
     "Ref": "OrchestratorApiDeploymentD878F32Eb33b95ac301fb3fd7dc4633ef9040008"
    },
    "RestApiId": {
     "Ref": "OrchestratorApiFA05180E"
    },
    "StageName": "test",
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorApi/DeploymentStage.test/Resource"
   }
  },
  "OrchestratorApiOPTIONS124BD440": {
   "Type": "AWS::ApiGateway::Method",
   "Properties": {
    "ApiKeyRequired": false,
    "AuthorizationType": "NONE",
    "HttpMethod": "OPTIONS",
    "Integration": {
     "IntegrationResponses": [
      {
       "ResponseParameters": {
        "method.response.header.Access-Control-Allow-Headers": "'Content-Type,Authorization,X-Admin-Secret'",
        "method.response.header.Access-Control-Allow-Origin": "'https://test.immivo.ai'",
        "method.response.header.Vary": "'Origin'",
        "method.response.header.Access-Control-Allow-Methods": "'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'"
       },
       "ResponseTemplates": {
        "application/json": "#set($origin = $input.params().header.get(\"Origin\"))\n#if($origin == \"\")\n  #set($origin = $input.params().header.get(\"origin\"))\n#end\n#if($origin == \"https://app.immivo.ai\" || $origin == \"https://immivo.ai\" || $origin == \"https://www.immivo.ai\" || $origin == \"https://admin.immivo.ai\")\n  #set($context.responseOverride.header.Access-Control-Allow-Origin = $origin)\n#end"
       },
       "StatusCode": "204"
      }
     ],
     "RequestTemplates": {
      "application/json": "{ statusCode: 200 }"
     },
     "Type": "MOCK"
    },
    "MethodResponses": [
     {
      "ResponseParameters": {
       "method.response.header.Access-Control-Allow-Headers": true,
       "method.response.header.Access-Control-Allow-Origin": true,
       "method.response.header.Vary": true,
       "method.response.header.Access-Control-Allow-Methods": true
      },
      "StatusCode": "204"
     }
    ],
    "ResourceId": {
     "Fn::GetAtt": [
      "OrchestratorApiFA05180E",
      "RootResourceId"
     ]
    },
    "RestApiId": {
     "Ref": "OrchestratorApiFA05180E"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorApi/Default/OPTIONS/Resource"
   }
  },
  "OrchestratorApiproxy426E8F4E": {
   "Type": "AWS::ApiGateway::Resource",
   "Properties": {
    "ParentId": {
     "Fn::GetAtt": [
      "OrchestratorApiFA05180E",
      "RootResourceId"
     ]
    },
    "PathPart": "{proxy+}",
    "RestApiId": {
     "Ref": "OrchestratorApiFA05180E"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorApi/Default/{proxy+}/Resource"
   }
  },
  "OrchestratorApiproxyOPTIONS0E0C159E": {
   "Type": "AWS::ApiGateway::Method",
   "Properties": {
    "ApiKeyRequired": false,
    "AuthorizationType": "NONE",
    "HttpMethod": "OPTIONS",
    "Integration": {
     "IntegrationResponses": [
      {
       "ResponseParameters": {
        "method.response.header.Access-Control-Allow-Headers": "'Content-Type,Authorization,X-Admin-Secret'",
        "method.response.header.Access-Control-Allow-Origin": "'https://test.immivo.ai'",
        "method.response.header.Vary": "'Origin'",
        "method.response.header.Access-Control-Allow-Methods": "'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'"
       },
       "ResponseTemplates": {
        "application/json": "#set($origin = $input.params().header.get(\"Origin\"))\n#if($origin == \"\")\n  #set($origin = $input.params().header.get(\"origin\"))\n#end\n#if($origin == \"https://app.immivo.ai\" || $origin == \"https://immivo.ai\" || $origin == \"https://www.immivo.ai\" || $origin == \"https://admin.immivo.ai\")\n  #set($context.responseOverride.header.Access-Control-Allow-Origin = $origin)\n#end"
       },
       "StatusCode": "204"
      }
     ],
     "RequestTemplates": {
      "application/json": "{ statusCode: 200 }"
     },
     "Type": "MOCK"
    },
    "MethodResponses": [
     {
      "ResponseParameters": {
       "method.response.header.Access-Control-Allow-Headers": true,
       "method.response.header.Access-Control-Allow-Origin": true,
       "method.response.header.Vary": true,
       "method.response.header.Access-Control-Allow-Methods": true
      },
      "StatusCode": "204"
     }
    ],
    "ResourceId": {
     "Ref": "OrchestratorApiproxy426E8F4E"
    },
    "RestApiId": {
     "Ref": "OrchestratorApiFA05180E"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorApi/Default/{proxy+}/OPTIONS/Resource"
   }
  },
  "OrchestratorApiproxyANYApiPermissionImmivoTestOrchestratorApi107387D0ANYproxy3C75C3FC": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "OrchestratorLambdaA7A0AD32",
      "Arn"
     ]
    },
    "Principal": "apigateway.amazonaws.com",
    "SourceArn": {
     "Fn::Join": [
      "",
      [
       "arn:aws:execute-api:eu-central-1:463090596988:",
       {
        "Ref": "OrchestratorApiFA05180E"
       },
       "/",
       {
        "Ref": "OrchestratorApiDeploymentStagetest5B74FABD"
       },
       "/*/*"
      ]
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorApi/Default/{proxy+}/ANY/ApiPermission.ImmivoTestOrchestratorApi107387D0.ANY..{proxy+}"
   }
  },
  "OrchestratorApiproxyANYApiPermissionTestImmivoTestOrchestratorApi107387D0ANYproxyD0992DB7": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "OrchestratorLambdaA7A0AD32",
      "Arn"
     ]
    },
    "Principal": "apigateway.amazonaws.com",
    "SourceArn": {
     "Fn::Join": [
      "",
      [
       "arn:aws:execute-api:eu-central-1:463090596988:",
       {
        "Ref": "OrchestratorApiFA05180E"
       },
       "/test-invoke-stage/*/*"
      ]
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorApi/Default/{proxy+}/ANY/ApiPermission.Test.ImmivoTestOrchestratorApi107387D0.ANY..{proxy+}"
   }
  },
  "OrchestratorApiproxyANY03FB7B53": {
   "Type": "AWS::ApiGateway::Method",
   "Properties": {
    "AuthorizationType": "NONE",
    "HttpMethod": "ANY",
    "Integration": {
     "IntegrationHttpMethod": "POST",
     "Type": "AWS_PROXY",
     "Uri": {
      "Fn::Join": [
       "",
       [
        "arn:aws:apigateway:eu-central-1:lambda:path/2015-03-31/functions/",
        {
         "Fn::GetAtt": [
          "OrchestratorLambdaA7A0AD32",
          "Arn"
         ]
        },
        "/invocations"
       ]
      ]
     }
    },
    "ResourceId": {
     "Ref": "OrchestratorApiproxy426E8F4E"
    },
    "RestApiId": {
     "Ref": "OrchestratorApiFA05180E"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorApi/Default/{proxy+}/ANY/Resource"
   }
  },
  "OrchestratorApiANYApiPermissionImmivoTestOrchestratorApi107387D0ANYD16787C2": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "OrchestratorLambdaA7A0AD32",
      "Arn"
     ]
    },
    "Principal": "apigateway.amazonaws.com",
    "SourceArn": {
     "Fn::Join": [
      "",
      [
       "arn:aws:execute-api:eu-central-1:463090596988:",
       {
        "Ref": "OrchestratorApiFA05180E"
       },
       "/",
       {
        "Ref": "OrchestratorApiDeploymentStagetest5B74FABD"
       },
       "/*/"
      ]
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorApi/Default/ANY/ApiPermission.ImmivoTestOrchestratorApi107387D0.ANY.."
   }
  },
  "OrchestratorApiANYApiPermissionTestImmivoTestOrchestratorApi107387D0ANY9E39664D": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "OrchestratorLambdaA7A0AD32",
      "Arn"
     ]
    },
    "Principal": "apigateway.amazonaws.com",
    "SourceArn": {
     "Fn::Join": [
      "",
      [
       "arn:aws:execute-api:eu-central-1:463090596988:",
       {
        "Ref": "OrchestratorApiFA05180E"
       },
       "/test-invoke-stage/*/"
      ]
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorApi/Default/ANY/ApiPermission.Test.ImmivoTestOrchestratorApi107387D0.ANY.."
   }
  },
  "OrchestratorApiANY0AC930C1": {
   "Type": "AWS::ApiGateway::Method",
   "Properties": {
    "AuthorizationType": "NONE",
    "HttpMethod": "ANY",
    "Integration": {
     "IntegrationHttpMethod": "POST",
     "Type": "AWS_PROXY",
     "Uri": {
      "Fn::Join": [
       "",
       [
        "arn:aws:apigateway:eu-central-1:lambda:path/2015-03-31/functions/",
        {
         "Fn::GetAtt": [
          "OrchestratorLambdaA7A0AD32",
          "Arn"
         ]
        },
        "/invocations"
       ]
      ]
     }
    },
    "ResourceId": {
     "Fn::GetAtt": [
      "OrchestratorApiFA05180E",
      "RootResourceId"
     ]
    },
    "RestApiId": {
     "Ref": "OrchestratorApiFA05180E"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorApi/Default/ANY/Resource"
   }
  },
  "OrchestratorApiDefault4XX21F3CEDD": {
   "Type": "AWS::ApiGateway::GatewayResponse",
   "Properties": {
    "ResponseParameters": {
     "gatewayresponse.header.Access-Control-Allow-Origin": "'https://test.immivo.ai'",
     "gatewayresponse.header.Access-Control-Allow-Headers": "'Content-Type,Authorization,X-Admin-Secret'",
     "gatewayresponse.header.Access-Control-Allow-Methods": "'GET,POST,PUT,DELETE,PATCH,OPTIONS'"
    },
    "ResponseType": "DEFAULT_4XX",
    "RestApiId": {
     "Ref": "OrchestratorApiFA05180E"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorApi/Default4XX/Resource"
   }
  },
  "OrchestratorApiDefault5XX926F0626": {
   "Type": "AWS::ApiGateway::GatewayResponse",
   "Properties": {
    "ResponseParameters": {
     "gatewayresponse.header.Access-Control-Allow-Origin": "'https://test.immivo.ai'",
     "gatewayresponse.header.Access-Control-Allow-Headers": "'Content-Type,Authorization,X-Admin-Secret'",
     "gatewayresponse.header.Access-Control-Allow-Methods": "'GET,POST,PUT,DELETE,PATCH,OPTIONS'"
    },
    "ResponseType": "DEFAULT_5XX",
    "RestApiId": {
     "Ref": "OrchestratorApiFA05180E"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/OrchestratorApi/Default5XX/Resource"
   }
  },
  "EmailIngestBucketD823E4FB": {
   "Type": "AWS::S3::Bucket",
   "Properties": {
    "BucketEncryption": {
     "ServerSideEncryptionConfiguration": [
      {
       "ServerSideEncryptionByDefault": {
        "SSEAlgorithm": "AES256"
       }
      }
     ]
    },
    "LifecycleConfiguration": {
     "Rules": [
      {
       "ExpirationInDays": 7,
       "Status": "Enabled"
      }
     ]
    },
    "PublicAccessBlockConfiguration": {
     "BlockPublicAcls": true,
     "BlockPublicPolicy": true,
     "IgnorePublicAcls": true,
     "RestrictPublicBuckets": true
    },
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/EmailIngestBucket/Resource"
   }
  },
  "EmailIngestBucketPolicyB4E9DD11": {
   "Type": "AWS::S3::BucketPolicy",
   "Properties": {
    "Bucket": {
     "Ref": "EmailIngestBucketD823E4FB"
    },
    "PolicyDocument": {
     "Statement": [
      {
       "Action": "s3:*",
       "Condition": {
        "Bool": {
         "aws:SecureTransport": "false"
        }
       },
       "Effect": "Deny",
       "Principal": {
        "AWS": "*"
       },
       "Resource": [
        {
         "Fn::GetAtt": [
          "EmailIngestBucketD823E4FB",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "EmailIngestBucketD823E4FB",
             "Arn"
            ]
           },
           "/*"
          ]
         ]
        }
       ]
      }
     ],
     "Version": "2012-10-17"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/EmailIngestBucket/Policy/Resource"
   }
  },
  "EmailIngestBucketNotifications8283E1F9": {
   "Type": "Custom::S3BucketNotifications",
   "Properties": {
    "ServiceToken": {
     "Fn::GetAtt": [
      "BucketNotificationsHandler050a0587b7544547bf325f094a3db8347ECC3691",
      "Arn"
     ]
    },
    "BucketName": {
     "Ref": "EmailIngestBucketD823E4FB"
    },
    "NotificationConfiguration": {
     "LambdaFunctionConfigurations": [
      {
       "Events": [
        "s3:ObjectCreated:*"
       ],
       "LambdaFunctionArn": {
        "Fn::GetAtt": [
         "EmailProcessor218EC076",
         "Arn"
        ]
       }
      }
     ]
    },
    "Managed": true,
    "SkipDestinationValidation": false
   },
   "DependsOn": [
    "EmailIngestBucketAllowBucketNotificationsToImmivoTestEmailProcessor24B70991D1DE8989",
    "EmailIngestBucketPolicyB4E9DD11"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/EmailIngestBucket/Notifications/Resource"
   }
  },
  "EmailIngestBucketAllowBucketNotificationsToImmivoTestEmailProcessor24B70991D1DE8989": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "EmailProcessor218EC076",
      "Arn"
     ]
    },
    "Principal": "s3.amazonaws.com",
    "SourceAccount": "463090596988",
    "SourceArn": {
     "Fn::GetAtt": [
      "EmailIngestBucketD823E4FB",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/EmailIngestBucket/AllowBucketNotificationsToImmivoTestEmailProcessor24B70991"
   }
  },
  "EmailProcessorServiceRole637381CE": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ],
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/EmailProcessor/ServiceRole/Resource"
   }
  },
  "EmailProcessorServiceRoleDefaultPolicy0B15DAB8": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "s3:GetBucket*",
        "s3:GetObject*",
        "s3:List*"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "EmailIngestBucketD823E4FB",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "EmailIngestBucketD823E4FB",
             "Arn"
            ]
           },
           "/*"
          ]
         ]
        }
       ]
      },
      {
       "Action": [
        "secretsmanager:DescribeSecret",
        "secretsmanager:GetSecretValue"
       ],
       "Effect": "Allow",
       "Resource": [
        "arn:aws:secretsmanager:eu-central-1:463090596988:secret:Immivo-App-Secret-test-??????",
        {
         "Ref": "DBSecretD58955BC"
        }
       ]
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "EmailProcessorServiceRoleDefaultPolicy0B15DAB8",
    "Roles": [
     {
      "Ref": "EmailProcessorServiceRole637381CE"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/EmailProcessor/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "EmailProcessor218EC076": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": "cdk-hnb659fds-assets-463090596988-eu-central-1",
     "S3Key": "e43faa84e807b82a1b6ab4c0369726145445dec663b40a48de4b82bc1b38488a.zip"
    },
    "Environment": {
     "Variables": {
      "STAGE": "test",
      "DB_SECRET_ARN": {
       "Ref": "DBSecretD58955BC"
      },
      "DB_ENDPOINT": {
       "Fn::GetAtt": [
        "PostgresInstance19CDD68A",
        "Endpoint.Address"
       ]
      },
      "ORCHESTRATOR_API_URL": {
       "Fn::Join": [
        "",
        [
         "https://",
         {
          "Ref": "OrchestratorApiFA05180E"
         },
         ".execute-api.eu-central-1.",
         {
          "Ref": "AWS::URLSuffix"
         },
         "/",
         {
          "Ref": "OrchestratorApiDeploymentStagetest5B74FABD"
         },
         "/"
        ]
       ]
      },
      "APP_SECRET_ARN": "arn:aws:secretsmanager:eu-central-1:463090596988:secret:Immivo-App-Secret-test"
     }
    },
    "Handler": "index.handler",
    "MemorySize": 512,
    "Role": {
     "Fn::GetAtt": [
      "EmailProcessorServiceRole637381CE",
      "Arn"
     ]
    },
    "Runtime": "nodejs22.x",
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "Timeout": 60
   },
   "DependsOn": [
    "EmailProcessorServiceRoleDefaultPolicy0B15DAB8",
    "EmailProcessorServiceRole637381CE"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/EmailProcessor/Resource",
    "aws:asset:path": "asset.e43faa84e807b82a1b6ab4c0369726145445dec663b40a48de4b82bc1b38488a",
    "aws:asset:is-bundled": true,
    "aws:asset:property": "Code"
   }
  },
  "EmailProcessorLogGroup29EAFE92": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "LogGroupName": {
     "Fn::Join": [
      "",
      [
       "/aws/lambda/",
       {
        "Ref": "EmailProcessor218EC076"
       }
      ]
     ]
    },
    "RetentionInDays": 731,
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/EmailProcessor/LogGroup/Resource"
   }
  },
  "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ],
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/Resource"
   }
  },
  "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": "s3:PutBucketNotification",
       "Effect": "Allow",
       "Resource": {
        "Fn::GetAtt": [
         "EmailIngestBucketD823E4FB",
         "Arn"
        ]
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36",
    "Roles": [
     {
      "Ref": "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/DefaultPolicy/Resource"
   }
  },
  "BucketNotificationsHandler050a0587b7544547bf325f094a3db8347ECC3691": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Description": "AWS CloudFormation handler for \"Custom::S3BucketNotifications\" resources (@aws-cdk/aws-s3)",
    "Code": {
     "ZipFile": "import boto3  # type: ignore\nimport json\nimport logging\nimport urllib.request\n\ns3 = boto3.client(\"s3\")\n\nEVENTBRIDGE_CONFIGURATION = 'EventBridgeConfiguration'\nCONFIGURATION_TYPES = [\"TopicConfigurations\", \"QueueConfigurations\", \"LambdaFunctionConfigurations\"]\n\ndef handler(event: dict, context):\n  response_status = \"SUCCESS\"\n  error_message = \"\"\n  try:\n    props = event[\"ResourceProperties\"]\n    notification_configuration = props[\"NotificationConfiguration\"]\n    managed = props.get('Managed', 'true').lower() == 'true'\n    skipDestinationValidation = props.get('SkipDestinationValidation', 'false').lower() == 'true'\n    stack_id = event['StackId']\n    old = event.get(\"OldResourceProperties\", {}).get(\"NotificationConfiguration\", {})\n    if managed:\n      config = handle_managed(event[\"RequestType\"], notification_configuration)\n    else:\n      config = handle_unmanaged(props[\"BucketName\"], stack_id, event[\"RequestType\"], notification_configuration, old)\n    s3.put_bucket_notification_configuration(Bucket=props[\"BucketName\"], NotificationConfiguration=config, SkipDestinationValidation=skipDestinationValidation)\n  except Exception as e:\n    logging.exception(\"Failed to put bucket notification configuration\")\n    response_status = \"FAILED\"\n    error_message = f\"Error: {str(e)}. \"\n  finally:\n    submit_response(event, context, response_status, error_message)\n\ndef handle_managed(request_type, notification_configuration):\n  if request_type == 'Delete':\n    return {}\n  return notification_configuration\n\ndef handle_unmanaged(bucket, stack_id, request_type, notification_configuration, old):\n  def get_id(n):\n    n['Id'] = ''\n    sorted_notifications = sort_filter_rules(n)\n    strToHash=json.dumps(sorted_notifications, sort_keys=True).replace('\"Name\": \"prefix\"', '\"Name\": \"Prefix\"').replace('\"Name\": \"suffix\"', '\"Name\": \"Suffix\"')\n    return f\"{stack_id}-{hash(strToHash)}\"\n  def with_id(n):\n    n['Id'] = get_id(n)\n    return n\n\n  external_notifications = {}\n  existing_notifications = s3.get_bucket_notification_configuration(Bucket=bucket)\n  for t in CONFIGURATION_TYPES:\n    if request_type == 'Update':\n        old_incoming_ids = [get_id(n) for n in old.get(t, [])]\n        external_notifications[t] = [n for n in existing_notifications.get(t, []) if not get_id(n) in old_incoming_ids]      \n    elif request_type == 'Delete':\n        external_notifications[t] = [n for n in existing_notifications.get(t, []) if not n['Id'].startswith(f\"{stack_id}-\")]\n    elif request_type == 'Create':\n        external_notifications[t] = [n for n in existing_notifications.get(t, [])]\n  if EVENTBRIDGE_CONFIGURATION in existing_notifications:\n    external_notifications[EVENTBRIDGE_CONFIGURATION] = existing_notifications[EVENTBRIDGE_CONFIGURATION]\n\n  if request_type == 'Delete':\n    return external_notifications\n\n  notifications = {}\n  for t in CONFIGURATION_TYPES:\n    external = external_notifications.get(t, [])\n    incoming = [with_id(n) for n in notification_configuration.get(t, [])]\n    notifications[t] = external + incoming\n\n  if EVENTBRIDGE_CONFIGURATION in notification_configuration:\n    notifications[EVENTBRIDGE_CONFIGURATION] = notification_configuration[EVENTBRIDGE_CONFIGURATION]\n  elif EVENTBRIDGE_CONFIGURATION in external_notifications:\n    notifications[EVENTBRIDGE_CONFIGURATION] = external_notifications[EVENTBRIDGE_CONFIGURATION]\n\n  return notifications\n\ndef submit_response(event: dict, context, response_status: str, error_message: str):\n  response_body = json.dumps(\n    {\n      \"Status\": response_status,\n      \"Reason\": f\"{error_message}See the details in CloudWatch Log Stream: {context.log_stream_name}\",\n      \"PhysicalResourceId\": event.get(\"PhysicalResourceId\") or event[\"LogicalResourceId\"],\n      \"StackId\": event[\"StackId\"],\n      \"RequestId\": event[\"RequestId\"],\n      \"LogicalResourceId\": event[\"LogicalResourceId\"],\n      \"NoEcho\": False,\n    }\n  ).encode(\"utf-8\")\n  headers = {\"content-type\": \"\", \"content-length\": str(len(response_body))}\n  try:\n    req = urllib.request.Request(url=event[\"ResponseURL\"], headers=headers, data=response_body, method=\"PUT\")\n    with urllib.request.urlopen(req) as response:\n      print(response.read().decode(\"utf-8\"))\n    print(\"Status code: \" + response.reason)\n  except Exception as e:\n      print(\"send(..) failed executing request.urlopen(..): \" + str(e))\n\ndef sort_filter_rules(json_obj):\n  if not isinstance(json_obj, dict):\n      return json_obj\n  for key, value in json_obj.items():\n      if isinstance(value, dict):\n          json_obj[key] = sort_filter_rules(value)\n      elif isinstance(value, list):\n          json_obj[key] = [sort_filter_rules(item) for item in value]\n  if \"Filter\" in json_obj and \"Key\" in json_obj[\"Filter\"] and \"FilterRules\" in json_obj[\"Filter\"][\"Key\"]:\n      filter_rules = json_obj[\"Filter\"][\"Key\"][\"FilterRules\"]\n      sorted_filter_rules = sorted(filter_rules, key=lambda x: x[\"Name\"])\n      json_obj[\"Filter\"][\"Key\"][\"FilterRules\"] = sorted_filter_rules\n  return json_obj"
    },
    "Handler": "index.handler",
    "Role": {
     "Fn::GetAtt": [
      "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC",
      "Arn"
     ]
    },
    "Runtime": "python3.13",
    "Timeout": 300,
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "DependsOn": [
    "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36",
    "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Resource"
   }
  },
  "FrontendLambdaServiceRoleC530666C": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ],
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/FrontendLambda/ServiceRole/Resource"
   }
  },
  "FrontendLambda8ACF4B3B": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "ImageUri": {
      "Fn::Sub": "463090596988.dkr.ecr.eu-central-1.${AWS::URLSuffix}/cdk-hnb659fds-container-assets-463090596988-eu-central-1:2e16f8d426a6c4f5f2c9a11f31d7cfc20e1ae6229972f0a6fe1d80a43f903f2f"
     }
    },
    "Environment": {
     "Variables": {
      "RUNTIME_API_URL": {
       "Fn::Join": [
        "",
        [
         "https://",
         {
          "Ref": "OrchestratorApiFA05180E"
         },
         ".execute-api.eu-central-1.",
         {
          "Ref": "AWS::URLSuffix"
         },
         "/",
         {
          "Ref": "OrchestratorApiDeploymentStagetest5B74FABD"
         },
         "/"
        ]
       ]
      },
      "RUNTIME_STREAM_URL": {
       "Fn::GetAtt": [
        "OrchestratorLambdaFunctionUrl11B98229",
        "FunctionUrl"
       ]
      },
      "RUNTIME_USER_POOL_ID": {
       "Ref": "ImmivoUserPool48AD5837"
      },
      "RUNTIME_USER_POOL_CLIENT_ID": {
       "Ref": "ImmivoUserPoolImmivoClient41F7052B"
      },
      "RUNTIME_ADMIN_USER_POOL_ID": {
       "Ref": "ImmivoAdminUserPool1121EFDE"
      },
      "RUNTIME_ADMIN_USER_POOL_CLIENT_ID": {
       "Ref": "ImmivoAdminUserPoolImmivoAdminClientC11B7155"
      },
      "RUNTIME_AWS_REGION": "eu-central-1",
      "RUNTIME_MEDIA_CDN_URL": "https://test-media.immivo.ai",
      "NEXT_PUBLIC_API_URL": {
       "Fn::Join": [
        "",
        [
         "https://",
         {
          "Ref": "OrchestratorApiFA05180E"
         },
         ".execute-api.eu-central-1.",
         {
          "Ref": "AWS::URLSuffix"
         },
         "/",
         {
          "Ref": "OrchestratorApiDeploymentStagetest5B74FABD"
         },
         "/"
        ]
       ]
      },
      "NEXT_PUBLIC_USER_POOL_ID": {
       "Ref": "ImmivoUserPool48AD5837"
      },
      "NEXT_PUBLIC_USER_POOL_CLIENT_ID": {
       "Ref": "ImmivoUserPoolImmivoClient41F7052B"
      },
      "NEXT_PUBLIC_AWS_REGION": "eu-central-1",
      "PORT": "3000",
      "AWS_LAMBDA_EXEC_WRAPPER": "/opt/extensions/lambda-adapter"
     }
    },
    "MemorySize": 2048,
    "PackageType": "Image",
    "Role": {
     "Fn::GetAtt": [
      "FrontendLambdaServiceRoleC530666C",
      "Arn"
     ]
    },
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "Timeout": 30
   },
   "DependsOn": [
    "FrontendLambdaServiceRoleC530666C"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/FrontendLambda/Resource",
    "aws:asset:path": "asset.2e16f8d426a6c4f5f2c9a11f31d7cfc20e1ae6229972f0a6fe1d80a43f903f2f",
    "aws:asset:dockerfile-path": "Dockerfile",
    "aws:asset:docker-build-args": {
     "NEXT_PUBLIC_AWS_REGION": "eu-central-1",
     "NEXT_PUBLIC_MEDIA_CDN_URL": "https://test-media.immivo.ai"
    },
    "aws:asset:property": "Code.ImageUri"
   }
  },
  "FrontendLambdaLogGroupF61F1686": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "LogGroupName": {
     "Fn::Join": [
      "",
      [
       "/aws/lambda/",
       {
        "Ref": "FrontendLambda8ACF4B3B"
       }
      ]
     ]
    },
    "RetentionInDays": 731,
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/FrontendLambda/LogGroup/Resource"
   }
  },
  "FrontendLambdaFunctionUrl1B051328": {
   "Type": "AWS::Lambda::Url",
   "Properties": {
    "AuthType": "NONE",
    "TargetFunctionArn": {
     "Fn::GetAtt": [
      "FrontendLambda8ACF4B3B",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/FrontendLambda/FunctionUrl/Resource"
   }
  },
  "FrontendLambdainvokefunctionurl6F8608B9": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunctionUrl",
    "FunctionName": {
     "Fn::GetAtt": [
      "FrontendLambda8ACF4B3B",
      "Arn"
     ]
    },
    "FunctionUrlAuthType": "NONE",
    "Principal": "*"
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/FrontendLambda/invoke-function-url"
   }
  },
  "FrontendLambdainvokefunctionBB8CC149": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "FrontendLambda8ACF4B3B",
      "Arn"
     ]
    },
    "InvokedViaFunctionUrl": true,
    "Principal": "*"
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/FrontendLambda/invoke-function"
   }
  },
  "MediaOACC4276BB0": {
   "Type": "AWS::CloudFront::OriginAccessControl",
   "Properties": {
    "OriginAccessControlConfig": {
     "Description": "OAC for Immivo Media Bucket",
     "Name": "ImmivoTestMediaOAC8146DBFF",
     "OriginAccessControlOriginType": "s3",
     "SigningBehavior": "always",
     "SigningProtocol": "sigv4"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/MediaOAC/Resource"
   }
  },
  "MediaCDN30A5345E": {
   "Type": "AWS::CloudFront::Distribution",
   "Properties": {
    "DistributionConfig": {
     "Aliases": [
      "test-media.immivo.ai"
     ],
     "Comment": "Immivo Media CDN (test)",
     "DefaultCacheBehavior": {
      "AllowedMethods": [
       "GET",
       "HEAD"
      ],
      "CachePolicyId": "658327ea-f89d-4fab-a63d-7e88639e58f6",
      "Compress": true,
      "TargetOriginId": "ImmivoTestMediaCDNOrigin10818660C",
      "ViewerProtocolPolicy": "redirect-to-https"
     },
     "Enabled": true,
     "HttpVersion": "http2and3",
     "IPV6Enabled": true,
     "Origins": [
      {
       "DomainName": {
        "Fn::GetAtt": [
         "MediaBucketBCBB02BA",
         "RegionalDomainName"
        ]
       },
       "Id": "ImmivoTestMediaCDNOrigin10818660C",
       "OriginAccessControlId": {
        "Fn::GetAtt": [
         "MediaOACC4276BB0",
         "Id"
        ]
       },
       "S3OriginConfig": {
        "OriginAccessIdentity": ""
       }
      }
     ],
     "PriceClass": "PriceClass_100",
     "ViewerCertificate": {
      "AcmCertificateArn": "arn:aws:acm:us-east-1:463090596988:certificate/b61f08cd-54f2-4f62-8e0a-9a69264e0436",
      "MinimumProtocolVersion": "TLSv1.3_2025",
      "SslSupportMethod": "sni-only"
     }
    },
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/MediaCDN/Resource"
   }
  },
  "MediaDnsRecord7D520F66": {
   "Type": "AWS::Route53::RecordSet",
   "Properties": {
    "AliasTarget": {
     "DNSName": {
      "Fn::GetAtt": [
       "MediaCDN30A5345E",
       "DomainName"
      ]
     },
     "HostedZoneId": {
      "Fn::FindInMap": [
       "AWSCloudFrontPartitionHostedZoneIdMap",
       {
        "Ref": "AWS::Partition"
       },
       "zoneId"
      ]
     }
    },
    "HostedZoneId": "Z10381383JI4OXGQXAULB",
    "Name": "test-media.immivo.ai.",
    "Type": "A"
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/MediaDnsRecord/Resource"
   }
  },
  "LandingVideoDeployAwsCliLayer7FF82229": {
   "Type": "AWS::Lambda::LayerVersion",
   "Properties": {
    "Content": {
     "S3Bucket": "cdk-hnb659fds-assets-463090596988-eu-central-1",
     "S3Key": "0cfdecad2260a3a84ad0c2d08a77e03c9d25e26c7b52f26b1e1faf97aef92f18.zip"
    },
    "Description": "/opt/awscli/aws"
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/LandingVideoDeploy/AwsCliLayer/Resource",
    "aws:asset:path": "asset.0cfdecad2260a3a84ad0c2d08a77e03c9d25e26c7b52f26b1e1faf97aef92f18.zip",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Content"
   }
  },
  "LandingVideoDeployCustomResource2048MiB2048MiB4FC83F07": {
   "Type": "Custom::CDKBucketDeployment",
   "Properties": {
    "ServiceToken": {
     "Fn::GetAtt": [
      "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C2048MiB2048MiBD44B8A53",
      "Arn"
     ]
    },
    "SourceBucketNames": [
     "cdk-hnb659fds-assets-463090596988-eu-central-1"
    ],
    "SourceObjectKeys": [
     "38c3cbfae814645b1dd770cf8dcfc133fb8e7fa320a09e9a17fd69a1f5e60979.zip"
    ],
    "DestinationBucketName": {
     "Ref": "MediaBucketBCBB02BA"
    },
    "DestinationBucketKeyPrefix": "public/",
    "WaitForDistributionInvalidation": true,
    "Prune": true,
    "OutputObjectKeys": true
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/LandingVideoDeploy/CustomResource-2048MiB-2048MiB/Default"
   }
  },
  "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C2048MiB2048MiBServiceRoleE8335660": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ],
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C2048MiB2048MiB/ServiceRole/Resource"
   }
  },
  "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C2048MiB2048MiBServiceRoleDefaultPolicyB72D5CB5": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "s3:GetBucket*",
        "s3:GetObject*",
        "s3:List*"
       ],
       "Effect": "Allow",
       "Resource": [
        "arn:aws:s3:::cdk-hnb659fds-assets-463090596988-eu-central-1",
        "arn:aws:s3:::cdk-hnb659fds-assets-463090596988-eu-central-1/*"
       ]
      },
      {
       "Action": [
        "s3:Abort*",
        "s3:DeleteObject*",
        "s3:GetBucket*",
        "s3:GetObject*",
        "s3:List*",
        "s3:PutObject",
        "s3:PutObjectLegalHold",
        "s3:PutObjectRetention",
        "s3:PutObjectTagging",
        "s3:PutObjectVersionTagging"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "MediaBucketBCBB02BA",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "MediaBucketBCBB02BA",
             "Arn"
            ]
           },
           "/*"
          ]
         ]
        }
       ]
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C2048MiB2048MiBServiceRoleDefaultPolicyB72D5CB5",
    "Roles": [
     {
      "Ref": "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C2048MiB2048MiBServiceRoleE8335660"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C2048MiB2048MiB/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C2048MiB2048MiBD44B8A53": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": "cdk-hnb659fds-assets-463090596988-eu-central-1",
     "S3Key": "3423a042b818e31c1e34a19d6689ab2e5f9b70fcbe9e71df66f241b20a200bd9.zip"
    },
    "Environment": {
     "Variables": {
      "AWS_CA_BUNDLE": "/etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem"
     }
    },
    "EphemeralStorage": {
     "Size": 2048
    },
    "Handler": "index.handler",
    "Layers": [
     {
      "Ref": "LandingVideoDeployAwsCliLayer7FF82229"
     }
    ],
    "MemorySize": 2048,
    "Role": {
     "Fn::GetAtt": [
      "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C2048MiB2048MiBServiceRoleE8335660",
      "Arn"
     ]
    },
    "Runtime": "python3.13",
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "Timeout": 900
   },
   "DependsOn": [
    "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C2048MiB2048MiBServiceRoleDefaultPolicyB72D5CB5",
    "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C2048MiB2048MiBServiceRoleE8335660"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C2048MiB2048MiB/Resource",
    "aws:asset:path": "asset.3423a042b818e31c1e34a19d6689ab2e5f9b70fcbe9e71df66f241b20a200bd9",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Code"
   }
  },
  "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C2048MiB2048MiBLogGroupA9164DD5": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "LogGroupName": {
     "Fn::Join": [
      "",
      [
       "/aws/lambda/",
       {
        "Ref": "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C2048MiB2048MiBD44B8A53"
       }
      ]
     ]
    },
    "RetentionInDays": 731,
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C2048MiB2048MiB/LogGroup/Resource"
   }
  },
  "FrontendCDNF4E135DE": {
   "Type": "AWS::CloudFront::Distribution",
   "Properties": {
    "DistributionConfig": {
     "Aliases": [
      "test.immivo.ai"
     ],
     "CacheBehaviors": [
      {
       "AllowedMethods": [
        "GET",
        "HEAD"
       ],
       "CachePolicyId": "658327ea-f89d-4fab-a63d-7e88639e58f6",
       "Compress": true,
       "PathPattern": "/_next/static/*",
       "TargetOriginId": "ImmivoTestFrontendCDNOrigin12DA08DAA",
       "ViewerProtocolPolicy": "redirect-to-https"
      }
     ],
     "Comment": "Immivo Frontend (test)",
     "DefaultCacheBehavior": {
      "AllowedMethods": [
       "GET",
       "HEAD",
       "OPTIONS",
       "PUT",
       "PATCH",
       "POST",
       "DELETE"
      ],
      "CachePolicyId": "4135ea2d-6df8-44a3-9df3-4b5a84be39ad",
      "Compress": true,
      "OriginRequestPolicyId": "b689b0a8-53d0-40ab-baf2-68738e2966ac",
      "TargetOriginId": "ImmivoTestFrontendCDNOrigin12DA08DAA",
      "ViewerProtocolPolicy": "redirect-to-https"
     },
     "Enabled": true,
     "HttpVersion": "http2and3",
     "IPV6Enabled": true,
     "Origins": [
      {
       "CustomOriginConfig": {
        "OriginProtocolPolicy": "https-only",
        "OriginSSLProtocols": [
         "TLSv1.2"
        ]
       },
       "DomainName": {
        "Fn::Select": [
         2,
         {
          "Fn::Split": [
           "/",
           {
            "Fn::GetAtt": [
             "FrontendLambdaFunctionUrl1B051328",
             "FunctionUrl"
            ]
           }
          ]
         }
        ]
       },
       "Id": "ImmivoTestFrontendCDNOrigin12DA08DAA"
      }
     ],
     "PriceClass": "PriceClass_100",
     "ViewerCertificate": {
      "AcmCertificateArn": "arn:aws:acm:us-east-1:463090596988:certificate/b61f08cd-54f2-4f62-8e0a-9a69264e0436",
      "MinimumProtocolVersion": "TLSv1.3_2025",
      "SslSupportMethod": "sni-only"
     }
    },
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/FrontendCDN/Resource"
   }
  },
  "FrontendDnsRecordE6D77025": {
   "Type": "AWS::Route53::RecordSet",
   "Properties": {
    "AliasTarget": {
     "DNSName": {
      "Fn::GetAtt": [
       "FrontendCDNF4E135DE",
       "DomainName"
      ]
     },
     "HostedZoneId": {
      "Fn::FindInMap": [
       "AWSCloudFrontPartitionHostedZoneIdMap",
       {
        "Ref": "AWS::Partition"
       },
       "zoneId"
      ]
     }
    },
    "HostedZoneId": "Z10381383JI4OXGQXAULB",
    "Name": "test.immivo.ai.",
    "Type": "A"
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/FrontendDnsRecord/Resource"
   }
  },
  "ApiCDN1A2125ED": {
   "Type": "AWS::CloudFront::Distribution",
   "Properties": {
    "DistributionConfig": {
     "Aliases": [
      "test-api.immivo.ai"
     ],
     "Comment": "Immivo API (test)",
     "DefaultCacheBehavior": {
      "AllowedMethods": [
       "GET",
       "HEAD",
       "OPTIONS",
       "PUT",
       "PATCH",
       "POST",
       "DELETE"
      ],
      "CachePolicyId": "4135ea2d-6df8-44a3-9df3-4b5a84be39ad",
      "Compress": true,
      "OriginRequestPolicyId": "b689b0a8-53d0-40ab-baf2-68738e2966ac",
      "TargetOriginId": "ImmivoTestApiCDNOrigin1ACF0186F",
      "ViewerProtocolPolicy": "redirect-to-https"
     },
     "Enabled": true,
     "HttpVersion": "http2and3",
     "IPV6Enabled": true,
     "Origins": [
      {
       "CustomOriginConfig": {
        "OriginProtocolPolicy": "https-only",
        "OriginSSLProtocols": [
         "TLSv1.2"
        ]
       },
       "DomainName": {
        "Fn::Select": [
         0,
         {
          "Fn::Split": [
           "/",
           {
            "Fn::Select": [
             1,
             {
              "Fn::Split": [
               "://",
               {
                "Fn::Join": [
                 "",
                 [
                  "https://",
                  {
                   "Ref": "OrchestratorApiFA05180E"
                  },
                  ".execute-api.eu-central-1.",
                  {
                   "Ref": "AWS::URLSuffix"
                  },
                  "/",
                  {
                   "Ref": "OrchestratorApiDeploymentStagetest5B74FABD"
                  },
                  "/"
                 ]
                ]
               }
              ]
             }
            ]
           }
          ]
         }
        ]
       },
       "Id": "ImmivoTestApiCDNOrigin1ACF0186F",
       "OriginPath": "/test"
      }
     ],
     "PriceClass": "PriceClass_100",
     "ViewerCertificate": {
      "AcmCertificateArn": "arn:aws:acm:us-east-1:463090596988:certificate/b61f08cd-54f2-4f62-8e0a-9a69264e0436",
      "MinimumProtocolVersion": "TLSv1.3_2025",
      "SslSupportMethod": "sni-only"
     }
    },
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ApiCDN/Resource"
   }
  },
  "ApiDnsRecordD7F299CB": {
   "Type": "AWS::Route53::RecordSet",
   "Properties": {
    "AliasTarget": {
     "DNSName": {
      "Fn::GetAtt": [
       "ApiCDN1A2125ED",
       "DomainName"
      ]
     },
     "HostedZoneId": {
      "Fn::FindInMap": [
       "AWSCloudFrontPartitionHostedZoneIdMap",
       {
        "Ref": "AWS::Partition"
       },
       "zoneId"
      ]
     }
    },
    "HostedZoneId": "Z10381383JI4OXGQXAULB",
    "Name": "test-api.immivo.ai.",
    "Type": "A"
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ApiDnsRecord/Resource"
   }
  },
  "ApiWaf": {
   "Type": "AWS::WAFv2::WebACL",
   "Properties": {
    "DefaultAction": {
     "Allow": {}
    },
    "Name": "Immivo-API-WAF-test",
    "Rules": [
     {
      "Name": "AWSManagedRulesCommonRuleSet",
      "OverrideAction": {
       "None": {}
      },
      "Priority": 1,
      "Statement": {
       "ManagedRuleGroupStatement": {
        "ExcludedRules": [
         {
          "Name": "SizeRestrictions_BODY"
         },
         {
          "Name": "CrossSiteScripting_BODY"
         }
        ],
        "Name": "AWSManagedRulesCommonRuleSet",
        "VendorName": "AWS"
       }
      },
      "VisibilityConfig": {
       "CloudWatchMetricsEnabled": true,
       "MetricName": "CommonRules",
       "SampledRequestsEnabled": true
      }
     },
     {
      "Name": "AWSManagedRulesSQLiRuleSet",
      "OverrideAction": {
       "None": {}
      },
      "Priority": 2,
      "Statement": {
       "ManagedRuleGroupStatement": {
        "Name": "AWSManagedRulesSQLiRuleSet",
        "VendorName": "AWS"
       }
      },
      "VisibilityConfig": {
       "CloudWatchMetricsEnabled": true,
       "MetricName": "SQLiRules",
       "SampledRequestsEnabled": true
      }
     },
     {
      "Name": "AWSManagedRulesKnownBadInputsRuleSet",
      "OverrideAction": {
       "None": {}
      },
      "Priority": 3,
      "Statement": {
       "ManagedRuleGroupStatement": {
        "Name": "AWSManagedRulesKnownBadInputsRuleSet",
        "VendorName": "AWS"
       }
      },
      "VisibilityConfig": {
       "CloudWatchMetricsEnabled": true,
       "MetricName": "BadInputRules",
       "SampledRequestsEnabled": true
      }
     },
     {
      "Action": {
       "Block": {}
      },
      "Name": "RateLimit",
      "Priority": 4,
      "Statement": {
       "RateBasedStatement": {
        "AggregateKeyType": "IP",
        "Limit": 2000
       }
      },
      "VisibilityConfig": {
       "CloudWatchMetricsEnabled": true,
       "MetricName": "RateLimit",
       "SampledRequestsEnabled": true
      }
     }
    ],
    "Scope": "REGIONAL",
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "VisibilityConfig": {
     "CloudWatchMetricsEnabled": true,
     "MetricName": "ImmivoApiWaf-test",
     "SampledRequestsEnabled": true
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ApiWaf"
   }
  },
  "ApiWafAssociation": {
   "Type": "AWS::WAFv2::WebACLAssociation",
   "Properties": {
    "ResourceArn": {
     "Fn::Join": [
      "",
      [
       "arn:aws:apigateway:eu-central-1::/restapis/",
       {
        "Ref": "OrchestratorApiFA05180E"
       },
       "/stages/",
       {
        "Ref": "OrchestratorApiDeploymentStagetest5B74FABD"
       }
      ]
     ]
    },
    "WebACLArn": {
     "Fn::GetAtt": [
      "ApiWaf",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ApiWafAssociation"
   }
  },
  "CloudTrailBucket98B0BFE1": {
   "Type": "AWS::S3::Bucket",
   "Properties": {
    "BucketEncryption": {
     "ServerSideEncryptionConfiguration": [
      {
       "ServerSideEncryptionByDefault": {
        "SSEAlgorithm": "AES256"
       }
      }
     ]
    },
    "LifecycleConfiguration": {
     "Rules": [
      {
       "ExpirationInDays": 90,
       "Status": "Enabled"
      }
     ]
    },
    "PublicAccessBlockConfiguration": {
     "BlockPublicAcls": true,
     "BlockPublicPolicy": true,
     "IgnorePublicAcls": true,
     "RestrictPublicBuckets": true
    },
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/CloudTrailBucket/Resource"
   }
  },
  "CloudTrailBucketPolicy2A856177": {
   "Type": "AWS::S3::BucketPolicy",
   "Properties": {
    "Bucket": {
     "Ref": "CloudTrailBucket98B0BFE1"
    },
    "PolicyDocument": {
     "Statement": [
      {
       "Action": "s3:*",
       "Condition": {
        "Bool": {
         "aws:SecureTransport": "false"
        }
       },
       "Effect": "Deny",
       "Principal": {
        "AWS": "*"
       },
       "Resource": [
        {
         "Fn::GetAtt": [
          "CloudTrailBucket98B0BFE1",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "CloudTrailBucket98B0BFE1",
             "Arn"
            ]
           },
           "/*"
          ]
         ]
        }
       ]
      },
      {
       "Action": "s3:GetBucketAcl",
       "Effect": "Allow",
       "Principal": {
        "Service": "cloudtrail.amazonaws.com"
       },
       "Resource": {
        "Fn::GetAtt": [
         "CloudTrailBucket98B0BFE1",
         "Arn"
        ]
       }
      },
      {
       "Action": "s3:PutObject",
       "Condition": {
        "StringEquals": {
         "s3:x-amz-acl": "bucket-owner-full-control"
        }
       },
       "Effect": "Allow",
       "Principal": {
        "Service": "cloudtrail.amazonaws.com"
       },
       "Resource": {
        "Fn::Join": [
         "",
         [
          {
           "Fn::GetAtt": [
            "CloudTrailBucket98B0BFE1",
            "Arn"
           ]
          },
          "/AWSLogs/463090596988/*"
         ]
        ]
       }
      }
     ],
     "Version": "2012-10-17"
    }
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/CloudTrailBucket/Policy/Resource"
   }
  },
  "TrailLogGroup7A1F916A": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "LogGroupName": "/immivo/cloudtrail/test",
    "RetentionInDays": 90,
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/TrailLogGroup/Resource"
   }
  },
  "ImmivoTrailLogsRole9F4A9B8A": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "cloudtrail.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoTrail/LogsRole/Resource"
   }
  },
  "ImmivoTrailLogsRoleDefaultPolicy8D03D805": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "logs:CreateLogStream",
        "logs:PutLogEvents"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::GetAtt": [
         "TrailLogGroup7A1F916A",
         "Arn"
        ]
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "ImmivoTrailLogsRoleDefaultPolicy8D03D805",
    "Roles": [
     {
      "Ref": "ImmivoTrailLogsRole9F4A9B8A"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoTrail/LogsRole/DefaultPolicy/Resource"
   }
  },
  "ImmivoTrailC39560C4": {
   "Type": "AWS::CloudTrail::Trail",
   "Properties": {
    "CloudWatchLogsLogGroupArn": {
     "Fn::GetAtt": [
      "TrailLogGroup7A1F916A",
      "Arn"
     ]
    },
    "CloudWatchLogsRoleArn": {
     "Fn::GetAtt": [
      "ImmivoTrailLogsRole9F4A9B8A",
      "Arn"
     ]
    },
    "EnableLogFileValidation": true,
    "EventSelectors": [],
    "IncludeGlobalServiceEvents": true,
    "IsLogging": true,
    "IsMultiRegionTrail": false,
    "S3BucketName": {
     "Ref": "CloudTrailBucket98B0BFE1"
    },
    "Tags": [
     {
      "Key": "Project",
      "Value": "Immivo"
     },
     {
      "Key": "Stage",
      "Value": "test"
     }
    ],
    "TrailName": "Immivo-Trail-test"
   },
   "DependsOn": [
    "CloudTrailBucketPolicy2A856177",
    "ImmivoTrailLogsRoleDefaultPolicy8D03D805",
    "ImmivoTrailLogsRole9F4A9B8A"
   ],
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/ImmivoTrail/Resource"
   }
  },
  "CDKMetadata": {
   "Type": "AWS::CDK::Metadata",
   "Properties": {
    "Analytics": "v2:deflate64:H4sIAAAAAAAA/+0aaU8jOfa3TD6uiloGdkba/hZCoNFwREnokaaFkFPlJG5c5VrbFUhH+e/znq9yQkIPw9HQsxISlefjnX6XvZfu7f+a7v5EbtVOlt/scDZKFwNNspsEQNcLmu2li09V9nnRKshd+6tqfWj9q5W0SqKPiaa3ZO4hqh6VVHdEOWaTWhLNRNn6AMsylsszom7CwoKurBjOKwT06hFnWWuZ/PUVks2AhNbyanmVdMblp14nsbsMzDTATWaEcTJinOn5H6L028yq7CR334jsgIvMYytIZTc5qS7KU1KX2bT1QcuaJi1WzX7trE0nSrFJeQIj7TyXVKmLsiOp4x5mID9vggpDSJ6fB72BcmDk6s0Q+DaosKZkDQi/+qLWdEhGnDbwBtZWSmTMbBAm40f3pIf/GmEnzlif3TLHhKs3IPOnkfF2KHkjZFgrPCk1lWAu3oasj3O/2hqc9LSgpU4GNKsl0HssRV2BbQGxDlVOVSZZFbYG5JyL2zbnF7UeibrMHaXOO5yUEySoX3Nq3QPqxnuJx22Lp9Adppi8ewCHcpkomkmqVUFKMqESgpD5DezYgfMmCkxoSSUeJjMw0JKVk9YHP9H+HtKi4hgd7BJ6l/E6pz1Qjq6dqJ2fKM3IoCIZDWoLGMxev9G5VUzgB9Ak9t+QyAnVjTICvQ6xNuN2ebR6fdkykblKF4dEkxFR9KRUmpQZhd1oOWFohv7LBT/DlAF8olIZfhatcc15+Ols84uQMQjUWREJsgTTMvI/IgXjcx9fgVtOLxWVfaGNmNpVBZZNIlVbrKvL6qoSUqs+JXmfmgUHkEHUlQoGMyY117hxiObLJLIo+LKuURlFbgzzqCsrlkgGaHhAHs0HWkgwnMD3XXvzCEg/B4EzULSnPjZH5cIiiMmcaT5vZxnYJxvxxjyU3bFbZnJeAQZvS5IWYkZ4T8BClA0omrASFW+Z8wf0/vl5rCS2YwITOzyI0FmAN6hlclOAnYFFbySDlhjVYNSr33NGOCMqsmKYkrQRhqEM/0fH05p8ODRmvpm7TDgpRjm5LkVOv6j03Pw7wjMJqD6j/drPaDNZg66KxuK19EY3JWXOqfRIYRJEX69+EI+cD9jXZuGMSVHiUXOQEXgp7hxHwUo2nntelahlRs9I5QH0Dv0w4WciB8eovPVmQH4cwd4T9Y7kZ6Lvsda75cT9TTbdodzEJyqpgIiSfxTiZpviHvj7Rwro2bl/gvk+rK23QCD4N0aKdNEXHMM1JHd1QfODOa6sIHvIWEU4xBDIivzmdg4uaGdR1teyqU9unDpDBZmiu4HN29LNvXL52lD0PAofCj4v3KjJLU5K4IKGsVDwPTj48L6vwmDyFjl/udEf3mheiH2391nM73eTwCsq8Ye3l6daxPPTfGUbPJwmFm6rY7dgKHDk3j73wTlUIxDjMdKoleNxH/zS+z8L+DsR+Wxo34sSjfVZw1smav96AdYPOWTaxn9JDjW3mOP89KDObqg+DACcnS4s9IBAGmg/sUtkuwI0DwnilqISjlqtxSHlVNOL0ReaIVU+p7QlsD1+g/3rs/Z5+7h7iBkUdrxsX8xW0CHXGgtIoAaDU59RZUJaN2SaSDQ/o3oqcpP1HneHsORjt32I6a8bv5Bswkq/nwN+pCSnMiC5q4RaB2JPwLUBgsY6gNt1u14VvzEMr/AX1sR9iW/TDWdjms0zTvu2QIhM+zQeMiMrLDyHHWzCvr3T8W2yzJmx5u6s3nnuBaT3+DOkmg/8jDbxx882MdIFDPjehTmdVBZMoSITD76UPOpqeIOp9dRVfOcX590WtrVm4oae2Trn4PLoqNsH0cUthS1LLXWAJTkEIVN5UkAYj/opoXTaUPOslkTrFdA3K+OVMuwJeAwHp2ROfZcyGZgepBZlxEhdM9995zj3oZLYqqdXSzyCG4mQxt9uKQWrKTheSbjrGn6ziG9taiEa4JiBGc8VOHJPmZiYCaHyDlJbrVbjqtZnuGD1OdHEdeXxwFxtHnKmHwnvmxJ799Lpxiw1UnAuImYf/RkgUuni1KFDAbnPcxJt+ypAdG8au9F4xP+7e9/b5VRpKeb+nLj1yyQTk5JpkS6wpd4TAv1M7T6j3RXl4wGblJdV13R2Q6fa3EDZriw1nShaEMZDzwXDDJxH0/ZYH6sg9bgVMlRbpkFySsuJngae/lczSU8hLsqM4CH07XEDv6yqjfBDCKtoM54Gm+33aSYgQAKiPWy8gykQmbe1lmxUa0s7sddo+Om2aiJpUWtiWve2WQN2VSstingDa24GPKAlBOzfCuW7196dDCHmT4wZLR7ovid/VQn+HuGNayEAB/NiJPjf0M3ymSRrA52TbeI/OpzZKzcvdbdzvTK+9eYw6AHj6hGkcUYHuHggQ3svecHdYSwHtRl2nD6brmLEsMW0TEjFJvb2F/yXkV4f/EO7YuYyx1yx4Z3xRMb3daves5LiLvQybd1wYfI224/W4NQjl9UasZLI+RnNGcHEY+0+D7PnnqRjziZTHW1jcuINaXLIrBtQnCIbYb8ncm1PwKogaWqujVdroLvG5YNNN9NViA+mcQFOnmWE43ODlfbZW4HbK8ZAfTJAJRiWPcj7vVXt2NtvhCUgMtNFx4LUZiVW1J/Rgdshb7xaV3bMAdg9+xaRIuGkCQk5iVz9FZ5ueJBZH26Rl0Y7eOu5Hj02z8fECEkCNirA7JpowK6uVadJW6Qb7vn7dn+Bumwyt2iXx26S/F9YryUsdzyfuIM5AHZB0kO/5o8BsFIR2Rycra7cDdg9LtaoCzJqXu68HyUbDUVC2MDQVXC3RmiJewflUVrfgZ7YVzUNcR7vivdOHrvAoF/Dukwg1l+7ZlxUhNu+HIylfQp1KKTqcm7abxkXdT6GYkWni8G+DTq2L9IBmDSJ/HrwsJg3zE0OmbLJlq/3i8j/5gIyRvMaISS5VGo2xuc8dNWiDuiUzJgwRiIMHl/LMQrpI1irFpmI07IcrCLTO1rs4DFQuDnJpqFn7kq4orKJuX9Estpfs4aG65sXSvhrD1KAfRP8WUY7nJieUS/8uP55dxctjpWsqAtPW7PF8HQw+zndv97b3fvFvif+nmLZwPQmWdnt8biBTUYjeBLznKGCCff0+G1eXnSAuxFC41Ze3CyufgC9vbB2bB4WOYBlIvH98S/76aKNlZnEfOpr84ZVGti9h1rBG/6IU13IwBkDChXULRnP9kzr9nc6andOk/AVPeVeWi+tJRTc6WKI/1Z7xoADgRFOps7A7lifTjAsSlOp+yfA9oHpMRcjwgdUzkDd3ZnN+10zBmrjoeggzt+JzqaQcYexLIY2/THLmEEECVKIiR1Ta4e8ouU6YStxc3UOWNmMQYwzwclELUzRWTkxIafWVW2ewZ+RqkKge8BnWorX5FZlnKXtWwUFqmmz2cIBn/elX9S/Z3v/SffT3Z++KMZ2XNsu7dv/fwITO9UheDIAAA=="
   },
   "Metadata": {
    "aws:cdk:path": "Immivo-Test/CDKMetadata/Default"
   }
  }
 },
 "Outputs": {
  "OrchestratorFunctionUrl": {
   "Description": "Lambda Function URL for streaming (bypasses API GW 29s limit)",
   "Value": {
    "Fn::GetAtt": [
     "OrchestratorLambdaFunctionUrl11B98229",
     "FunctionUrl"
    ]
   }
  },
  "OrchestratorApiEndpoint8D207D42": {
   "Value": {
    "Fn::Join": [
     "",
     [
      "https://",
      {
       "Ref": "OrchestratorApiFA05180E"
      },
      ".execute-api.eu-central-1.",
      {
       "Ref": "AWS::URLSuffix"
      },
      "/",
      {
       "Ref": "OrchestratorApiDeploymentStagetest5B74FABD"
      },
      "/"
     ]
    ]
   }
  },
  "FrontendCustomUrl": {
   "Value": "https://test.immivo.ai"
  },
  "ApiCustomUrl": {
   "Value": "https://test-api.immivo.ai"
  },
  "VpcId": {
   "Value": {
    "Ref": "ImmivoVPCB1C78292"
   }
  },
  "DBEndpoint": {
   "Value": {
    "Fn::GetAtt": [
     "PostgresInstance19CDD68A",
     "Endpoint.Address"
    ]
   }
  },
  "EmailBucketName": {
   "Value": {
    "Ref": "EmailIngestBucketD823E4FB"
   }
  },
  "MediaBucketName": {
   "Value": {
    "Ref": "MediaBucketBCBB02BA"
   }
  },
  "MediaCDNUrl": {
   "Value": "https://test-media.immivo.ai"
  },
  "MediaDistributionId": {
   "Value": {
    "Ref": "MediaCDN30A5345E"
   }
  },
  "OrchestratorApiUrl": {
   "Value": {
    "Fn::Join": [
     "",
     [
      "https://",
      {
       "Ref": "OrchestratorApiFA05180E"
      },
      ".execute-api.eu-central-1.",
      {
       "Ref": "AWS::URLSuffix"
      },
      "/",
      {
       "Ref": "OrchestratorApiDeploymentStagetest5B74FABD"
      },
      "/"
     ]
    ]
   }
  },
  "FrontendUrl": {
   "Value": {
    "Fn::GetAtt": [
     "FrontendLambdaFunctionUrl1B051328",
     "FunctionUrl"
    ]
   }
  },
  "UserPoolId": {
   "Value": {
    "Ref": "ImmivoUserPool48AD5837"
   }
  },
  "UserPoolClientId": {
   "Value": {
    "Ref": "ImmivoUserPoolImmivoClient41F7052B"
   }
  },
  "AdminUserPoolId": {
   "Value": {
    "Ref": "ImmivoAdminUserPool1121EFDE"
   }
  },
  "AdminUserPoolClientId": {
   "Value": {
    "Ref": "ImmivoAdminUserPoolImmivoAdminClientC11B7155"
   }
  },
  "WafAclArn": {
   "Value": {
    "Fn::GetAtt": [
     "ApiWaf",
     "Arn"
    ]
   }
  }
 },
 "Mappings": {
  "AWSCloudFrontPartitionHostedZoneIdMap": {
   "aws": {
    "zoneId": "Z2FDTNDATAQYW2"
   },
   "aws-cn": {
    "zoneId": "Z3RFFRIM2A3IF5"
   }
  }
 },
 "Parameters": {
  "BootstrapVersion": {
   "Type": "AWS::SSM::Parameter::Value<String>",
   "Default": "/cdk-bootstrap/hnb659fds/version",
   "Description": "Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]"
  }
 },
 "Rules": {
  "CheckBootstrapVersion": {
   "Assertions": [
    {
     "Assert": {
      "Fn::Not": [
       {
        "Fn::Contains": [
         [
          "1",
          "2",
          "3",
          "4",
          "5"
         ],
         {
          "Ref": "BootstrapVersion"
         }
        ]
       }
      ]
     },
     "AssertDescription": "CDK bootstrap stack version 6 required. Please run 'cdk bootstrap' with a recent version of the CDK CLI."
    }
   ]
  }
 }
}